"use strict";angular.module("njcOnlinePleas",["ui.router","angular-spinkit","ngResource","ngSanitize","ngAnimate","angular-cache","truncate","socialLinks","formly","formlyBootstrap","multiStepForm","mgcrea.ngStrap","google.places"]),function(){function e(e){e.state("home",{url:"/",templateUrl:"js/partials/home.html",controller:"HomeController",controllerAs:"vm",resolve:{}}).state("form",{"abstract":!0,templateUrl:"js/partials/form.html",controller:"FormController",controllerAs:"vm",resolve:{}}).state("form.your-details",{templateUrl:"js/partials/your-details.html"}).state("form.your-offence",{templateUrl:"js/partials/your-offence.html"}).state("form.declaration",{templateUrl:"js/partials/declaration.html"}).state("form.review",{templateUrl:"js/partials/review.html"}).state("form.finish",{url:"/submitted",templateUrl:"js/partials/confirmation.html",controller:"FormConfirmationController",controllerAs:"vm",resolve:{}})}e.$inject=["$stateProvider"],angular.module("njcOnlinePleas").config(["$urlRouterProvider",function(e){e.when("","/")}]).config(["CacheFactoryProvider",function(e){angular.extend(e.defaults,{maxAge:9e5})}]).config(["$datepickerProvider",function(e){angular.extend(e.defaults,{modelDateFormat:"dd/MM/yyyy",dateFormat:"dd/MM/yyyy",dateType:"string",startWeek:1,useNative:!0,autoclose:!0,iconLeft:"fa fa-chevron-left",iconRight:"fa fa-chevron-right"})}]).controller("AppController",["$log","$scope","$rootScope",function(e,t,o){o.user={name:""}}]).config(e).constant("_",window._).run(["$log","$rootScope","$location","formlyValidationMessages","formlyConfig",function(e,t,o,a,r){r.setWrapper([{name:"customLabel",templateUrl:"js/partials/forms/wrappers/label.html"},{name:"customHasError",templateUrl:"js/partials/forms/wrappers/has-error.html"},{name:"note",templateUrl:"js/partials/forms/wrappers/field-note.html"},{name:"noteModal",templateUrl:"js/partials/forms/wrappers/field-note-modal.html"},{name:"dobSeperateFields",templateUrl:"js/partials/forms/wrappers/dob-seperate-fields.html"}]),r.setType([{"extends":"input",name:"customInput",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"select",name:"customSelect",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"radio",name:"customRatingRadio",templateUrl:"js/partials/forms/wrappers/custom-field-rating-radio.html",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"checkbox",name:"customCheckbox",templateUrl:"js/partials/forms/wrappers/custom-field-checkbox.html",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"multiCheckbox",name:"customMultiCheckbox",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"radio",name:"customRadio",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"textarea",name:"customTextarea",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"textarea",name:"customTextareaWithCounter",wrapper:["customLabel","customHasError"],controller:["$scope",function(e){function t(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=t}]},{"extends":"input",name:"customSplitDate",templateUrl:"js/partials/forms/custom-split-date.html",wrapper:["customLabel","customHasError"],controller:["$scope",function(e,t){function o(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}e.options.data.getValidationMessage=o}]}]),a.addTemplateOptionValueMessage("maxlength","maxlength","","is the maximum length","Too long"),a.addTemplateOptionValueMessage("minlength","minlength","","is the minimum length","Too short"),a.messages.required='to.label + " is required"',a.messages.email='$viewValue + " should be a valid email address"'}])}(),function(){function e(e,t,o,a,r,n){function l(){}l()}e.$inject=["$scope","$log","$rootScope","$state","$alert","$tooltip"],angular.module("njcOnlinePleas").controller("ConfirmationFormController",e)}(),function(){function e(e,t,o,a){function r(){}var n=this;n.model={},r()}e.$inject=["$scope","$log","$rootScope","$state"],angular.module("njcOnlinePleas").controller("FormConfirmationController",e)}(),function(){function e(e,t,o,a,r,n,l,i,s){function c(e){var t=new Date(e.year,e.month,e.day),o=["January","February","March","April","May","June","July","August","September","October","November","December"];return t.getDate()+" "+o[t.getMonth()].slice(0,3)+" "+t.getFullYear()}function u(e){e.year=2===e.year.length?Number("20"+e.year):e.year;var t=new Date(e.year,e.month,e.day);return t.getTime()/1e3}function m(e){return e.formatted_address}function d(e,t){if(!(_.isUndefined(t)||_.isUndefined(t.day)||_.isUndefined(t.month)||_.isUndefined(t.year))){var o={day:t.day||"",month:t.month||"",year:t.year||""};return formatDateYMD(o)}return!1}function p(t){var o=e.options.validation.messages[t];return o?o(e.fc.$viewValue,e.fc.$modelValue,e):void 0}function f(){y.errors={},y.model={}}function g(){r({title:"Holy guacamole!",content:"Best check yo self, you're not looking too good.",type:"danger",show:!1,container:"#alert-container",duration:2500,dismissable:!0})}function h(){}var y=this;y.steps=[{id:0,label:"Your details"},{id:1,label:"Your offence"},{id:2,label:"Declarations"},{id:3,label:"Review"}],y.current_step_id=0,y.place=null,y.errors=[],y.cleanupDate=c,y.cancelForm=function(){var t=n({scope:e,show:!0,content:"Are you sure you would like to exit the form?",templateUrl:"js/partials/yes-no-modal.html"});e.exitForm=function(e){e?(t.hide(),f(),a.go("home")):t.hide()}},y.submit=function(){var e=angular.copy(y.model);e.address=m(e.address),e.plead_guilty=e.plead_guilty?"YES":"NO",e.acknowledgement=e.acknowledgement?"YES":"NO",e.birthday=y.model.birthday,l.post("pleas",e).then(function(){a.go("form.finish")},function(){g()})},y.options={data:{}},y.options.data.getValidationMessage=p,y.prev=function(e){y.errors=[],y.current_step_id--,a.go("form."+e.replace("_","-"))},y.next=function(e,t){y.checkRequiredFields(e),y.checkRequiredFields(e),0===y.errors.length&&(a.go("form."+t.replace("_","-")),y.current_step_id++)},y.checkRequiredFields=function(e){y.errors=[];var t=y.fields[e];if("your_details"===e){var o=d("birthday",y.model.birthday);if(o);else{_.find(y.fields.your_details,{key:"birthday"})}}if("declaration"!==e)t.forEach(function(e){e.formControl.$invalid&&y.errors.push({message:e.templateOptions.label+" is required"})});else{var a=!0;t.forEach(function(e){e.formControl.$invalid&&(a=!1)}),a||y.errors.push({message:"You must agree to both declarations to proceed"})}},y.finish=function(){a.go("form.finish")},y.model={your_details:{},your_offence:{},declarations:{}},y.model={contact_method:"email"},y.showMinorOffences=function(){},y.fields={},y.fields.your_details=[{name:"given_name",key:"given_name",type:"customInput",templateOptions:{label:"Given Name(s)",required:!0}},{name:"family_name",key:"family_name",type:"customInput",templateOptions:{label:"Family Name",required:!0}},{name:"address",key:"address",type:"customInput",templateOptions:{label:"Residential address",required:!0,"g-places-autocomplete":"g-places-autocomplete"},ngModelAttrs:{"g-places-autocomplete":{attribute:"g-places-autocomplete"}}},{name:"birthday",key:"birthday",type:"customInput",templateOptions:{label:"Date of Birth",placeholder:"dd/mm/yyyy",required:!0,past:!0},validators:{past:{expression:function(e,t,o){var a=t||e;if(!_.isUndefined(a)&&a.length>0){var r=a.split("/");if(3==r.length){var n=new Date;r=u({day:r[0],month:r[1]-1,year:r[2]});var l=u({day:n.getDate(),month:n.getMonth(),year:n.getFullYear()});if(l>r)return!0}}return!1},message:'"Date of birth must be a past date"'}}},{name:"contact_method",key:"contact_method",type:"customSelect",templateOptions:{label:"Preferred contact",required:!0,options:[{name:"Phone number",value:"phone"},{name:"Email",value:"email"}]}},{name:"contact",key:"contact",type:"customInput",templateOptions:{label:"Contact",placeholder:"Enter your contact",required:!0},expressionProperties:{"templateOptions.label":'"Contact " + model.contact_method'}}],y.fields.your_offence=[{name:"hearing_date",key:"hearing_date",type:"customInput",wrapper:"note",templateOptions:{label:"Date of your hearing",placeholder:"Enter the date of your hearing",required:!0,"bs-datepicker":"bs-datepicker",form_field_note:'This date is located on your summons document in the section "Where will the case be heard?"',future:!0},ngModelAttrs:{"bs-datepicker":{attribute:"bs-datepicker"},"form-field-note":{attribute:"form-field-note"}},validators:{future:{expression:function(e,t,o){var a=t||e;if(!_.isUndefined(a)&&a.length>0){var r=a.split("/");if(3==r.length){var n=new Date;r=u({day:r[0],month:r[1]-1,year:r[2]});var l=u({day:n.getDate(),month:n.getMonth(),year:n.getFullYear()});if(r>l)return!0}}return!1},message:'"Date of your hearing must be a future date"'}}},{name:"offence_date",key:"offence_date",type:"customInput",templateOptions:{label:"Date of your offence",placeholder:"Enter the date your offence was committed",required:!0,"bs-datepicker":"bs-datepicker",past:!0},ngModelAttrs:{"bs-datepicker":{attribute:"bs-datepicker"}},validators:{past:{expression:function(e,t,o){var a=t||e;if(!_.isUndefined(a)&&a.length>0){var r=a.split("/");if(3==r.length){var n=new Date;r=u({day:r[0],month:r[1]-1,year:r[2]});var l=u({day:n.getDate(),month:n.getMonth(),year:n.getFullYear()});if(l>r)return!0}}return!1},message:'"Date of your offence must be a past date"'}}},{name:"offence_details",key:"offence_details",type:"customTextarea",wrapper:"noteModal",templateOptions:{label:"Details of your offence(s)",placeholder:"Enter the details of your offence(s) as described on your summons notice",required:!0,modal_url:"js/partials/minor-offences.html",form_field_note:"Offences for which you can submit a plea online"}},{name:"message",key:"message",type:"customTextareaWithCounter",wrapper:"note",templateOptions:{label:"Message to the Magistrate",placeholder:"Enter a message to be sent to the magistrate",maxlength:600,prepend:"This might include explaining why you offended, your personal or financial circumstances, and things you would like the magistrate to consider when deciding your sentence ",modal_url:"js/partials/information-for-the-magistrate.html",form_field_note:"show more"},ngModelAttrs:{form_field_note:{attribute:"form-field-note"}}}],e.loadModal=function(e){},y.fields.declaration=[{name:"acknowledgement",key:"acknowledgement",type:"customCheckbox",templateOptions:{no_label:!0,label:"I acknowledge I may plead guilty or not guilty. I acknowledge no police officer or other person told me to plead guilty",required:!0}},{name:"plead_guilty",key:"plead_guilty",type:"customCheckbox",templateOptions:{no_label:!0,label:"I plead guilty to the offence(s) listed in this form. This plea is entered voluntarily of my own free will",required:!0}}],h()}e.$inject=["$scope","$log","$rootScope","$state","$alert","$modal","$http","$interval","$sce"],angular.module("njcOnlinePleas").controller("FormController",e)}(),function(){function e(e,t,o,a){function r(){}var n=this;n.model={},n.login=function(){a.go("viewer")},r()}e.$inject=["$scope","$log","$rootScope","$state"],angular.module("njcOnlinePleas").controller("HomeController",e)}(),function(){function e(e,t){function o(){}o()}e.$inject=["$scope","$log"],angular.module("njcOnlinePleas").controller("YesNoModalController",e)}(),function(){angular.module("njcOnlinePleas").directive("formSteps",["$log",function(e){return{restrict:"EA",replace:!0,templateUrl:"js/partials/form-steps.directive.html",scope:{steps:"=",current:"="},link:function(e,t,o){}}}])}(),function(){angular.module("njcOnlinePleas").directive("formlyErrorSummary",["$log",function(e){return{scope:{},bindToController:{form:"=",fields:"="},templateUrl:"js/partials/formly-error-summary.directive.html",controllerAs:"vm",controller:function(){function e(e){return Object.keys(e.formControl.$error).map(function(t){return e.data.getValidationMessage(t)}).join(", ")}var t=this;t.getErrorAsList=e}}}])}(),function(){angular.module("njcOnlinePleas").directive("rating",["$log",function(e){return{restrict:"EA",replace:!0,templateUrl:"js/partials/rating.directive.html",scope:{},controllerAs:"vm",controller:["$scope","$log","RatingService",function(e,t,o){var a=this;a.submitted=!1,a.model={},a.rating_options=[{label:1,value:1,value_text:"Very difficult"},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7,value_text:"Very easy"}],a.fields=[{type:"customRatingRadio",key:"rating",templateOptions:{label:"Overall, how difficult or easy did you find this task?",labelProp:"label",valueProp:"value",required:!0,options:a.rating_options}},{type:"textarea",key:"comments",templateOptions:{label:"Comments",required:!1}}],a.submit=function(){o.create(a.model).then(function(e){a.submitted=!0},function(e){})}}],link:function(e,t,o){}}}])}(),function(){function e(e,t){return{create:function(e){return t.post("ratings",e)}}}e.$inject=["$log","$http"],angular.module("njcOnlinePleas").service("RatingService",e)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZXMuanMiLCJhcHAuanMiLCJtYWluLmpzIiwiY29udHJvbGxlcnMvY29uZmlybWF0aW9uLmNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9mb3JtLWNvbmZpcm1hdGlvbi5jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvZm9ybS5jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvaG9tZS5jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMveWVzLW5vLW1vZGFsLmNvbnRyb2xsZXIuanMiLCJkaXJlY3RpdmVzL2Zvcm0tc3RlcHMuZGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy9mb3JtbHktZXJyb3JzLmRpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvcmF0aW5nLmRpcmVjdGl2ZS5qcyIsInNlcnZpY2VzL3JhdGluZy5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJzdGF0ZUNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJyZXNvbHZlIiwiYWJzdHJhY3QiLCIkaW5qZWN0IiwiY29uZmlnIiwiJHVybFJvdXRlclByb3ZpZGVyIiwid2hlbiIsIkNhY2hlRmFjdG9yeVByb3ZpZGVyIiwiZXh0ZW5kIiwiZGVmYXVsdHMiLCJtYXhBZ2UiLCIkZGF0ZXBpY2tlclByb3ZpZGVyIiwibW9kZWxEYXRlRm9ybWF0IiwiZGF0ZUZvcm1hdCIsImRhdGVUeXBlIiwic3RhcnRXZWVrIiwidXNlTmF0aXZlIiwiYXV0b2Nsb3NlIiwiaWNvbkxlZnQiLCJpY29uUmlnaHQiLCIkbG9nIiwiJHNjb3BlIiwiJHJvb3RTY29wZSIsInVzZXIiLCJuYW1lIiwiY29uc3RhbnQiLCJ3aW5kb3ciLCJfIiwicnVuIiwiJGxvY2F0aW9uIiwiZm9ybWx5VmFsaWRhdGlvbk1lc3NhZ2VzIiwiZm9ybWx5Q29uZmlnIiwic2V0V3JhcHBlciIsInNldFR5cGUiLCJleHRlbmRzIiwid3JhcHBlciIsImdldFZhbGlkYXRpb25NZXNzYWdlIiwia2V5IiwibWVzc2FnZSIsIm9wdGlvbnMiLCJ2YWxpZGF0aW9uIiwibWVzc2FnZXMiLCJmYyIsIiR2aWV3VmFsdWUiLCIkbW9kZWxWYWx1ZSIsImRhdGEiLCJhZGRUZW1wbGF0ZU9wdGlvblZhbHVlTWVzc2FnZSIsInJlcXVpcmVkIiwiZW1haWwiLCJDb25maXJtYXRpb25Gb3JtQ29udHJvbGxlciIsIiRzdGF0ZSIsIiRhbGVydCIsIiR0b29sdGlwIiwiaW5pdCIsIkZvcm1Db25maXJtYXRpb25Db250cm9sbGVyIiwidm0iLCJ0aGlzIiwibW9kZWwiLCJGb3JtQ29udHJvbGxlciIsIiRtb2RhbCIsIiRodHRwIiwiJGludGVydmFsIiwiJHNjZSIsImZvcm1hdERhdGVGb3JDb3VydGxpbmsiLCJkYXRlIiwiZCIsIkRhdGUiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJtb250aG5hbWVzIiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwic2xpY2UiLCJnZXRGdWxsWWVhciIsImZvcm1hdERhdGVVbml4IiwibGVuZ3RoIiwiTnVtYmVyIiwiZ2V0VGltZSIsImNsZWFudXBHb29nbGVBZGRyZXNzIiwiYWRkcmVzcyIsImZvcm1hdHRlZF9hZGRyZXNzIiwiY2xlYW51cFNwbGl0RGF0ZSIsImlzVW5kZWZpbmVkIiwieW1kIiwiZm9ybWF0RGF0ZVlNRCIsInJlc2V0Rm9ybSIsImVycm9ycyIsImVycm9yIiwidGl0bGUiLCJjb250ZW50IiwidHlwZSIsInNob3ciLCJjb250YWluZXIiLCJkdXJhdGlvbiIsImRpc21pc3NhYmxlIiwic3RlcHMiLCJpZCIsImxhYmVsIiwiY3VycmVudF9zdGVwX2lkIiwicGxhY2UiLCJjbGVhbnVwRGF0ZSIsImNhbmNlbEZvcm0iLCJleGl0TW9kYWwiLCJzY29wZSIsImV4aXRGb3JtIiwiY29uZmlybSIsImhpZGUiLCJnbyIsInN1Ym1pdCIsImZpZWxkcyIsImNvcHkiLCJwbGVhZF9ndWlsdHkiLCJhY2tub3dsZWRnZW1lbnQiLCJiaXJ0aGRheSIsInBvc3QiLCJ0aGVuIiwicHJldiIsInByZXZfc3RlcCIsInJlcGxhY2UiLCJuZXh0IiwiY3VycmVudF9zdGVwIiwibmV4dF9zdGVwIiwiY2hlY2tSZXF1aXJlZEZpZWxkcyIsInN0ZXAiLCJmaW5kIiwieW91cl9kZXRhaWxzIiwiZm9yRWFjaCIsImZpZWxkIiwiZm9ybUNvbnRyb2wiLCIkaW52YWxpZCIsInB1c2giLCJ0ZW1wbGF0ZU9wdGlvbnMiLCJ2YWxpZCIsImZpbmlzaCIsInlvdXJfb2ZmZW5jZSIsImRlY2xhcmF0aW9ucyIsImNvbnRhY3RfbWV0aG9kIiwic2hvd01pbm9yT2ZmZW5jZXMiLCJnLXBsYWNlcy1hdXRvY29tcGxldGUiLCJuZ01vZGVsQXR0cnMiLCJhdHRyaWJ1dGUiLCJwbGFjZWhvbGRlciIsInBhc3QiLCJ2YWxpZGF0b3JzIiwiZXhwcmVzc2lvbiIsInZhbHVlIiwic3BsaXQiLCJ0b2RheSIsImV4cHJlc3Npb25Qcm9wZXJ0aWVzIiwidGVtcGxhdGVPcHRpb25zLmxhYmVsIiwiYnMtZGF0ZXBpY2tlciIsImZvcm1fZmllbGRfbm90ZSIsImZ1dHVyZSIsImZvcm0tZmllbGQtbm90ZSIsIm1vZGFsX3VybCIsIm1heGxlbmd0aCIsInByZXBlbmQiLCJsb2FkTW9kYWwiLCJtb2RhbCIsImRlY2xhcmF0aW9uIiwibm9fbGFiZWwiLCJIb21lQ29udHJvbGxlciIsImxvZ2luIiwiWWVzTm9Nb2RhbENvbnRyb2xsZXIiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsImN1cnJlbnQiLCJsaW5rIiwiZWxlbSIsImF0dHJzIiwiYmluZFRvQ29udHJvbGxlciIsImZvcm0iLCJnZXRFcnJvckFzTGlzdCIsIk9iamVjdCIsImtleXMiLCIkZXJyb3IiLCJtYXAiLCJqb2luIiwiUmF0aW5nU2VydmljZSIsInN1Ym1pdHRlZCIsInJhdGluZ19vcHRpb25zIiwidmFsdWVfdGV4dCIsImxhYmVsUHJvcCIsInZhbHVlUHJvcCIsImNyZWF0ZSIsImVyciIsInJhdGluZyIsInNlcnZp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QUFjLEtBQ2RELFlBQUEsU0FBQSxPQUFBLGdCQUFZLFNBQVNzQixFQUFRRCxFQUFNK0osR0FDakMsR0FBSTVILEdBQUtDLElBR1RELEdBQUc2SCxXQUFZLEVBRWY3SCxFQUFHRSxTQUNIRixFQUFHOEgsaUJBQ0FuRixNQUFTLEVBQUdnRCxNQUFTLEVBQUdvQyxXQUFjLG1CQUN0Q3BGLE1BQVMsRUFBR2dELE1BQVMsSUFDckJoRCxNQUFTLEVBQUdnRCxNQUFTLElBQ3JCaEQsTUFBUyxFQUFHZ0QsTUFBUyxJQUNyQmhELE1BQVMsRUFBR2dELE1BQVMsSUFDckJoRCxNQUFTLEVBQUdnRCxNQUFTLElBQ3JCaEQsTUFBUyxFQUFHZ0QsTUFBUyxFQUFHb0MsV0FBYyxjQUd6Qy9ILEVBQUd1RCxTQUVDbkIsS0FBTSxvQkFDTnRELElBQUssU0FDTCtGLGlCQUNFbEMsTUFBTyx5REFDUHFGLFVBQVcsUUFDWEMsVUFBVyxRQUNYekksVUFBVSxFQUNWUixRQUFTZ0IsRUFBRzhILGtCQUlkMUYsS0FBTSxXQUNOdEQsSUFBSyxXQUNMK0YsaUJBQ0VsQyxNQUFPLFdBQ1BuRCxVQUFVLEtBS2hCUSxFQUFHc0QsT0FBUyxXQUNWc0UsRUFDR00sT0FBT2xJLEVBQUdFLE9BQ1YyRCxLQUFLLFNBQVN2RSxHQUNiVSxFQUFHNkgsV0FBWSxHQUNkLFNBQVNNLFNBS2xCbEIsS0FBTSxTQUFTaEUsRUFBT2lFLEVBQU1DLFlDN0RwQyxXQVFFLFFBQVNTLEdBQWMvSixFQUFNd0MsR0FFM0IsT0FDRTZILE9BQVEsU0FBU0UsR0FDZixNQUFPL0gsR0FBTXVELEtBQUssVUFBV3dFLEtUZy9CbkNSLEVBQWNoTCxTQUFXLE9BQVEsU1N4L0JqQ1gsUUFBUUMsT0FBTyxrQkFDWm1NLFFBQVEsZ0JBQWlCVCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnbmpjT25saW5lUGxlYXMnLCBbXG4gICd1aS5yb3V0ZXInLFxuICAnYW5ndWxhci1zcGlua2l0JyxcbiAgJ25nUmVzb3VyY2UnLFxuICAnbmdTYW5pdGl6ZScsXG4gICduZ0FuaW1hdGUnLFxuICAnYW5ndWxhci1jYWNoZScsXG4gICd0cnVuY2F0ZScsXG4gICdzb2NpYWxMaW5rcycsXG4gICdmb3JtbHknLFxuICAnZm9ybWx5Qm9vdHN0cmFwJyxcbiAgJ211bHRpU3RlcEZvcm0nLFxuICAnbWdjcmVhLm5nU3RyYXAnLFxuICAnZ29vZ2xlLnBsYWNlcydcbl0pO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkdXJsUm91dGVyUHJvdmlkZXIpe1xuICAgICAgLy8gcm91dGUgdGhlIGRlZmF1bHQgc3RhdGUgdG8gdGhlIGFwcCBob21lXG4gICAgICAkdXJsUm91dGVyUHJvdmlkZXIud2hlbignJywgJy8nKTtcbiAgICB9KVxuICAgIC5jb25maWcoZnVuY3Rpb24gKENhY2hlRmFjdG9yeVByb3ZpZGVyKSB7XG4gICAgICBhbmd1bGFyLmV4dGVuZChDYWNoZUZhY3RvcnlQcm92aWRlci5kZWZhdWx0cywgeyBtYXhBZ2U6IDE1ICogNjAgKiAxMDAwIH0pO1xuICAgIH0pXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkZGF0ZXBpY2tlclByb3ZpZGVyKSB7XG4gICAgICBhbmd1bGFyLmV4dGVuZCgkZGF0ZXBpY2tlclByb3ZpZGVyLmRlZmF1bHRzLCB7XG4gICAgICAgIG1vZGVsRGF0ZUZvcm1hdDogJ2RkL01NL3l5eXknLFxuICAgICAgICBkYXRlRm9ybWF0OiAnZGQvTU0veXl5eScsXG4gICAgICAgIGRhdGVUeXBlOiAnc3RyaW5nJyxcbiAgICAgICAgc3RhcnRXZWVrOiAxLFxuICAgICAgICB1c2VOYXRpdmU6IHRydWUsXG4gICAgICAgIGF1dG9jbG9zZTogdHJ1ZSxcbiAgICAgICAgaWNvbkxlZnQ6IFwiZmEgZmEtY2hldnJvbi1sZWZ0XCIsXG4gICAgICAgIGljb25SaWdodDogXCJmYSBmYS1jaGV2cm9uLXJpZ2h0XCJcbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLmNvbnRyb2xsZXIoJ0FwcENvbnRyb2xsZXInLCBmdW5jdGlvbiAoJGxvZywgJHNjb3BlLCAkcm9vdFNjb3BlKSB7XG4gICAgICB2YXIgbWFpbiA9IHRoaXM7XG5cbiAgICAgICRyb290U2NvcGUudXNlciA9IHtcbiAgICAgICAgbmFtZTogXCJcIlxuICAgICAgfTtcblxuICAgICAgJGxvZy5sb2coXCJBcHBDb250cm9sbGVyIGxvYWRpbmdcIik7XG4gICAgfSlcbiAgICAuY29uZmlnKHN0YXRlQ29uZmlnKVxuICAgIC5jb25zdGFudCgnXycsIHdpbmRvdy5fKVxuICAgIC5ydW4oZnVuY3Rpb24oJGxvZywgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCBmb3JtbHlWYWxpZGF0aW9uTWVzc2FnZXMsIGZvcm1seUNvbmZpZyl7XG4gICAgICAkbG9nLmxvZyhcIlJ1bm5pbmcgdGhlIGFwcFwiKTtcblxuICAgICAgLy8gY3VzdG9tIGZvcm0gZmllbGQgd3JhcHBlcnNcbiAgICAgIGZvcm1seUNvbmZpZy5zZXRXcmFwcGVyKFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdjdXN0b21MYWJlbCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9sYWJlbC5odG1sJyxcbiAgICAgICAgfSxcbiAgICAgICAgLyp7XG4gICAgICAgICAgbmFtZTogJ2N1c3RvbUxhYmVsV2l0aENvdW50ZXInLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvbGFiZWwtd2l0aC1jb3VudGVyLmh0bWwnLFxuICAgICAgICB9LCovXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnY3VzdG9tSGFzRXJyb3InLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvaGFzLWVycm9yLmh0bWwnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ25vdGUnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvZmllbGQtbm90ZS5odG1sJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ25vdGVNb2RhbCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9maWVsZC1ub3RlLW1vZGFsLmh0bWwnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnZG9iU2VwZXJhdGVGaWVsZHMnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvZG9iLXNlcGVyYXRlLWZpZWxkcy5odG1sJ1xuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIC8vIGN1c3RvbSBmb3JtbHkgdGVtcGxhdGVzXG4gICAgICBmb3JtbHlDb25maWcuc2V0VHlwZShbe1xuICAgICAgICBleHRlbmRzOiAnaW5wdXQnLFxuICAgICAgICBuYW1lOiAnY3VzdG9tSW5wdXQnLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ3NlbGVjdCcsXG4gICAgICAgIG5hbWU6ICdjdXN0b21TZWxlY3QnLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ3JhZGlvJyxcbiAgICAgICAgbmFtZTogJ2N1c3RvbVJhdGluZ1JhZGlvJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9jdXN0b20tZmllbGQtcmF0aW5nLXJhZGlvLmh0bWwnLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ2NoZWNrYm94JyxcbiAgICAgICAgbmFtZTogJ2N1c3RvbUNoZWNrYm94JyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9jdXN0b20tZmllbGQtY2hlY2tib3guaHRtbCcsXG4gICAgICAgIHdyYXBwZXI6IFsnY3VzdG9tTGFiZWwnLCAnY3VzdG9tSGFzRXJyb3InXSxcbiAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAkc2NvcGUub3B0aW9ucy5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlID0gZ2V0VmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZShrZXkpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBleHRlbmRzOiAnbXVsdGlDaGVja2JveCcsXG4gICAgICAgIG5hbWU6ICdjdXN0b21NdWx0aUNoZWNrYm94JyxcbiAgICAgICAgd3JhcHBlcjogWydjdXN0b21MYWJlbCcsJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ3JhZGlvJyxcbiAgICAgICAgbmFtZTogJ2N1c3RvbVJhZGlvJyxcbiAgICAgICAgd3JhcHBlcjogWydjdXN0b21MYWJlbCcsICdjdXN0b21IYXNFcnJvciddLFxuICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICRzY29wZS5vcHRpb25zLmRhdGEuZ2V0VmFsaWRhdGlvbk1lc3NhZ2UgPSBnZXRWYWxpZGF0aW9uTWVzc2FnZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldFZhbGlkYXRpb25NZXNzYWdlKGtleSkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAkc2NvcGUub3B0aW9ucy52YWxpZGF0aW9uLm1lc3NhZ2VzW2tleV07XG4gICAgICAgICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZSgkc2NvcGUuZmMuJHZpZXdWYWx1ZSwgJHNjb3BlLmZjLiRtb2RlbFZhbHVlLCAkc2NvcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfV1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGV4dGVuZHM6ICd0ZXh0YXJlYScsXG4gICAgICAgIG5hbWU6ICdjdXN0b21UZXh0YXJlYScsXG4gICAgICAgIHdyYXBwZXI6IFsnY3VzdG9tTGFiZWwnLCAnY3VzdG9tSGFzRXJyb3InXSxcbiAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAkc2NvcGUub3B0aW9ucy5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlID0gZ2V0VmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZShrZXkpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBleHRlbmRzOiAndGV4dGFyZWEnLFxuICAgICAgICBuYW1lOiAnY3VzdG9tVGV4dGFyZWFXaXRoQ291bnRlcicsXG4gICAgICAgIHdyYXBwZXI6IFsnY3VzdG9tTGFiZWwnLCAnY3VzdG9tSGFzRXJyb3InXSxcbiAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAkc2NvcGUub3B0aW9ucy5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlID0gZ2V0VmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZShrZXkpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBleHRlbmRzOiAnaW5wdXQnLFxuICAgICAgICBuYW1lOiAnY3VzdG9tU3BsaXREYXRlJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwianMvcGFydGlhbHMvZm9ybXMvY3VzdG9tLXNwbGl0LWRhdGUuaHRtbFwiLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9nKSB7XG5cblxuICAgICAgICAgICRzY29wZS5vcHRpb25zLmRhdGEuZ2V0VmFsaWRhdGlvbk1lc3NhZ2UgPSBnZXRWYWxpZGF0aW9uTWVzc2FnZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldFZhbGlkYXRpb25NZXNzYWdlKGtleSkge1xuICAgICAgICAgICAgJGxvZy5sb2coXCJDVVNUT01ET0JcIik7XG4gICAgICAgICAgICAkbG9nLmxvZyhrZXkpO1xuICAgICAgICAgICAgJGxvZy5sb2coJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldKTtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1dXG4gICAgICB9XSk7XG5cbiAgICAgIC8vIGN1c3RvbSBmb3JtbHkgdmFsaWRhdGlvbiBtZXNzYWdlc1xuICAgICAgZm9ybWx5VmFsaWRhdGlvbk1lc3NhZ2VzLmFkZFRlbXBsYXRlT3B0aW9uVmFsdWVNZXNzYWdlKCdtYXhsZW5ndGgnLCAnbWF4bGVuZ3RoJywgJycsICdpcyB0aGUgbWF4aW11bSBsZW5ndGgnLCAnVG9vIGxvbmcnKTtcbiAgICAgIGZvcm1seVZhbGlkYXRpb25NZXNzYWdlcy5hZGRUZW1wbGF0ZU9wdGlvblZhbHVlTWVzc2FnZSgnbWlubGVuZ3RoJywgJ21pbmxlbmd0aCcsICcnLCAnaXMgdGhlIG1pbmltdW0gbGVuZ3RoJywgJ1RvbyBzaG9ydCcpO1xuICAgICAgZm9ybWx5VmFsaWRhdGlvbk1lc3NhZ2VzLm1lc3NhZ2VzLnJlcXVpcmVkID0gJ3RvLmxhYmVsICsgXCIgaXMgcmVxdWlyZWRcIic7XG4gICAgICBmb3JtbHlWYWxpZGF0aW9uTWVzc2FnZXMubWVzc2FnZXMuZW1haWwgPSAnJHZpZXdWYWx1ZSArIFwiIHNob3VsZCBiZSBhIHZhbGlkIGVtYWlsIGFkZHJlc3NcIic7XG4gICAgICAvL2Zvcm1seVZhbGlkYXRpb25NZXNzYWdlcy5hZGRTdHJpbmdNZXNzYWdlKCdtYXhsZW5ndGgnLCAnJyk7XG5cbiAgICAgICRsb2cubG9nKGZvcm1seVZhbGlkYXRpb25NZXNzYWdlcyk7XG4gICAgICAkbG9nLmxvZyhmb3JtbHlWYWxpZGF0aW9uTWVzc2FnZXMubWVzc2FnZXMpO1xuICAgIH0pO1xuXG4gIGZ1bmN0aW9uIHN0YXRlQ29uZmlnKCRzdGF0ZVByb3ZpZGVyKXtcbiAgICAkc3RhdGVQcm92aWRlclxuICBcdC5zdGF0ZSgnaG9tZScsIHsgLy8gc3RhdGUgZm9yIHNob3dpbmcgYWxsIG1vdmllc1xuICBcdFx0dXJsOiAnLycsXG4gIFx0XHR0ZW1wbGF0ZVVybDogJ2pzL3BhcnRpYWxzL2hvbWUuaHRtbCcsXG4gIFx0XHRjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzb2x2ZToge1xuXG4gICAgICB9XG4gIFx0fSlcbiAgICAuc3RhdGUoJ2Zvcm0nLCB7XG4gICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgIC8vdGVtcGxhdGU6ICc8dWktdmlldy8+JyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdGb3JtQ29udHJvbGxlcicsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXNvbHZlOiB7XG5cbiAgICAgIH1cbiAgXHR9KVxuICAgIC5zdGF0ZSgnZm9ybS55b3VyLWRldGFpbHMnLCB7XG4gIFx0XHQvL3VybDogJy9mb3JtL2RldGFpbHMnLFxuICBcdFx0dGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy95b3VyLWRldGFpbHMuaHRtbCcsXG4gIFx0fSlcbiAgICAuc3RhdGUoJ2Zvcm0ueW91ci1vZmZlbmNlJywge1xuICBcdFx0Ly91cmw6ICcvZm9ybS9vZmZlbmNlJyxcbiAgXHRcdHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMveW91ci1vZmZlbmNlLmh0bWwnLFxuICBcdH0pXG4gICAgLnN0YXRlKCdmb3JtLmRlY2xhcmF0aW9uJywge1xuICBcdFx0Ly91cmw6ICcvZm9ybS9kZWNsYXJhdGlvbicsXG4gIFx0XHR0ZW1wbGF0ZVVybDogJ2pzL3BhcnRpYWxzL2RlY2xhcmF0aW9uLmh0bWwnLFxuICBcdH0pXG4gICAgLnN0YXRlKCdmb3JtLnJldmlldycsIHtcbiAgXHRcdC8vdXJsOiAnL2Zvcm0vcmV2aWV3JyxcbiAgXHRcdHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvcmV2aWV3Lmh0bWwnLFxuICBcdH0pXG4gICAgLnN0YXRlKCdmb3JtLmZpbmlzaCcsIHtcbiAgXHRcdHVybDogJy9zdWJtaXR0ZWQnLFxuICBcdFx0dGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9jb25maXJtYXRpb24uaHRtbCcsXG4gIFx0XHRjb250cm9sbGVyOiAnRm9ybUNvbmZpcm1hdGlvbkNvbnRyb2xsZXInLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzb2x2ZToge1xuICAgICAgfVxuICBcdH0pO1xuICB9XG5cbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycsIFtcbiAgJ3VpLnJvdXRlcicsXG4gICdhbmd1bGFyLXNwaW5raXQnLFxuICAnbmdSZXNvdXJjZScsXG4gICduZ1Nhbml0aXplJyxcbiAgJ25nQW5pbWF0ZScsXG4gICdhbmd1bGFyLWNhY2hlJyxcbiAgJ3RydW5jYXRlJyxcbiAgJ3NvY2lhbExpbmtzJyxcbiAgJ2Zvcm1seScsXG4gICdmb3JtbHlCb290c3RyYXAnLFxuICAnbXVsdGlTdGVwRm9ybScsXG4gICdtZ2NyZWEubmdTdHJhcCcsXG4gICdnb29nbGUucGxhY2VzJ1xuXSk7XG5cbihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG4gIC8vIEFwcCBib290c3RyYXBwaW5nICsgRElcbiAgLypAbmdJbmplY3QqL1xuICBhbmd1bGFyLm1vZHVsZSgnbmpjT25saW5lUGxlYXMnKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJHVybFJvdXRlclByb3ZpZGVyKXtcbiAgICAgIC8vIHJvdXRlIHRoZSBkZWZhdWx0IHN0YXRlIHRvIHRoZSBhcHAgaG9tZVxuICAgICAgJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJycsICcvJyk7XG4gICAgfSlcbiAgICAuY29uZmlnKGZ1bmN0aW9uIChDYWNoZUZhY3RvcnlQcm92aWRlcikge1xuICAgICAgYW5ndWxhci5leHRlbmQoQ2FjaGVGYWN0b3J5UHJvdmlkZXIuZGVmYXVsdHMsIHsgbWF4QWdlOiAxNSAqIDYwICogMTAwMCB9KTtcbiAgICB9KVxuICAgIC5jb25maWcoZnVuY3Rpb24oJGRhdGVwaWNrZXJQcm92aWRlcikge1xuICAgICAgYW5ndWxhci5leHRlbmQoJGRhdGVwaWNrZXJQcm92aWRlci5kZWZhdWx0cywge1xuICAgICAgICBtb2RlbERhdGVGb3JtYXQ6ICdkZC9NTS95eXl5JyxcbiAgICAgICAgZGF0ZUZvcm1hdDogJ2RkL01NL3l5eXknLFxuICAgICAgICBkYXRlVHlwZTogJ3N0cmluZycsXG4gICAgICAgIHN0YXJ0V2VlazogMSxcbiAgICAgICAgdXNlTmF0aXZlOiB0cnVlLFxuICAgICAgICBhdXRvY2xvc2U6IHRydWUsXG4gICAgICAgIGljb25MZWZ0OiBcImZhIGZhLWNoZXZyb24tbGVmdFwiLFxuICAgICAgICBpY29uUmlnaHQ6IFwiZmEgZmEtY2hldnJvbi1yaWdodFwiXG4gICAgICB9KTtcbiAgICB9KVxuICAgIC5jb250cm9sbGVyKCdBcHBDb250cm9sbGVyJywgZnVuY3Rpb24gKCRsb2csICRzY29wZSwgJHJvb3RTY29wZSkge1xuICAgICAgdmFyIG1haW4gPSB0aGlzO1xuXG4gICAgICAkcm9vdFNjb3BlLnVzZXIgPSB7XG4gICAgICAgIG5hbWU6IFwiXCJcbiAgICAgIH07XG5cbiAgICAgIHZvaWQgMDtcbiAgICB9KVxuICAgIC5jb25maWcoc3RhdGVDb25maWcpXG4gICAgLmNvbnN0YW50KCdfJywgd2luZG93Ll8pXG4gICAgLnJ1bihmdW5jdGlvbigkbG9nLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sIGZvcm1seVZhbGlkYXRpb25NZXNzYWdlcywgZm9ybWx5Q29uZmlnKXtcbiAgICAgIHZvaWQgMDtcblxuICAgICAgLy8gY3VzdG9tIGZvcm0gZmllbGQgd3JhcHBlcnNcbiAgICAgIGZvcm1seUNvbmZpZy5zZXRXcmFwcGVyKFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdjdXN0b21MYWJlbCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9sYWJlbC5odG1sJyxcbiAgICAgICAgfSxcbiAgICAgICAgLyp7XG4gICAgICAgICAgbmFtZTogJ2N1c3RvbUxhYmVsV2l0aENvdW50ZXInLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvbGFiZWwtd2l0aC1jb3VudGVyLmh0bWwnLFxuICAgICAgICB9LCovXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnY3VzdG9tSGFzRXJyb3InLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvaGFzLWVycm9yLmh0bWwnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ25vdGUnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvZmllbGQtbm90ZS5odG1sJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ25vdGVNb2RhbCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9maWVsZC1ub3RlLW1vZGFsLmh0bWwnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnZG9iU2VwZXJhdGVGaWVsZHMnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybXMvd3JhcHBlcnMvZG9iLXNlcGVyYXRlLWZpZWxkcy5odG1sJ1xuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIC8vIGN1c3RvbSBmb3JtbHkgdGVtcGxhdGVzXG4gICAgICBmb3JtbHlDb25maWcuc2V0VHlwZShbe1xuICAgICAgICBleHRlbmRzOiAnaW5wdXQnLFxuICAgICAgICBuYW1lOiAnY3VzdG9tSW5wdXQnLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ3NlbGVjdCcsXG4gICAgICAgIG5hbWU6ICdjdXN0b21TZWxlY3QnLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ3JhZGlvJyxcbiAgICAgICAgbmFtZTogJ2N1c3RvbVJhdGluZ1JhZGlvJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9jdXN0b20tZmllbGQtcmF0aW5nLXJhZGlvLmh0bWwnLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ2NoZWNrYm94JyxcbiAgICAgICAgbmFtZTogJ2N1c3RvbUNoZWNrYm94JyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3Jtcy93cmFwcGVycy9jdXN0b20tZmllbGQtY2hlY2tib3guaHRtbCcsXG4gICAgICAgIHdyYXBwZXI6IFsnY3VzdG9tTGFiZWwnLCAnY3VzdG9tSGFzRXJyb3InXSxcbiAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAkc2NvcGUub3B0aW9ucy5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlID0gZ2V0VmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZShrZXkpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBleHRlbmRzOiAnbXVsdGlDaGVja2JveCcsXG4gICAgICAgIG5hbWU6ICdjdXN0b21NdWx0aUNoZWNrYm94JyxcbiAgICAgICAgd3JhcHBlcjogWydjdXN0b21MYWJlbCcsJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZXh0ZW5kczogJ3JhZGlvJyxcbiAgICAgICAgbmFtZTogJ2N1c3RvbVJhZGlvJyxcbiAgICAgICAgd3JhcHBlcjogWydjdXN0b21MYWJlbCcsICdjdXN0b21IYXNFcnJvciddLFxuICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICRzY29wZS5vcHRpb25zLmRhdGEuZ2V0VmFsaWRhdGlvbk1lc3NhZ2UgPSBnZXRWYWxpZGF0aW9uTWVzc2FnZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldFZhbGlkYXRpb25NZXNzYWdlKGtleSkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAkc2NvcGUub3B0aW9ucy52YWxpZGF0aW9uLm1lc3NhZ2VzW2tleV07XG4gICAgICAgICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZSgkc2NvcGUuZmMuJHZpZXdWYWx1ZSwgJHNjb3BlLmZjLiRtb2RlbFZhbHVlLCAkc2NvcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfV1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGV4dGVuZHM6ICd0ZXh0YXJlYScsXG4gICAgICAgIG5hbWU6ICdjdXN0b21UZXh0YXJlYScsXG4gICAgICAgIHdyYXBwZXI6IFsnY3VzdG9tTGFiZWwnLCAnY3VzdG9tSGFzRXJyb3InXSxcbiAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAkc2NvcGUub3B0aW9ucy5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlID0gZ2V0VmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZShrZXkpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBleHRlbmRzOiAndGV4dGFyZWEnLFxuICAgICAgICBuYW1lOiAnY3VzdG9tVGV4dGFyZWFXaXRoQ291bnRlcicsXG4gICAgICAgIHdyYXBwZXI6IFsnY3VzdG9tTGFiZWwnLCAnY3VzdG9tSGFzRXJyb3InXSxcbiAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAkc2NvcGUub3B0aW9ucy5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlID0gZ2V0VmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZShrZXkpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1dXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBleHRlbmRzOiAnaW5wdXQnLFxuICAgICAgICBuYW1lOiAnY3VzdG9tU3BsaXREYXRlJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwianMvcGFydGlhbHMvZm9ybXMvY3VzdG9tLXNwbGl0LWRhdGUuaHRtbFwiLFxuICAgICAgICB3cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9nKSB7XG5cblxuICAgICAgICAgICRzY29wZS5vcHRpb25zLmRhdGEuZ2V0VmFsaWRhdGlvbk1lc3NhZ2UgPSBnZXRWYWxpZGF0aW9uTWVzc2FnZTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldFZhbGlkYXRpb25NZXNzYWdlKGtleSkge1xuICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAkc2NvcGUub3B0aW9ucy52YWxpZGF0aW9uLm1lc3NhZ2VzW2tleV07XG4gICAgICAgICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZSgkc2NvcGUuZmMuJHZpZXdWYWx1ZSwgJHNjb3BlLmZjLiRtb2RlbFZhbHVlLCAkc2NvcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfV1cbiAgICAgIH1dKTtcblxuICAgICAgLy8gY3VzdG9tIGZvcm1seSB2YWxpZGF0aW9uIG1lc3NhZ2VzXG4gICAgICBmb3JtbHlWYWxpZGF0aW9uTWVzc2FnZXMuYWRkVGVtcGxhdGVPcHRpb25WYWx1ZU1lc3NhZ2UoJ21heGxlbmd0aCcsICdtYXhsZW5ndGgnLCAnJywgJ2lzIHRoZSBtYXhpbXVtIGxlbmd0aCcsICdUb28gbG9uZycpO1xuICAgICAgZm9ybWx5VmFsaWRhdGlvbk1lc3NhZ2VzLmFkZFRlbXBsYXRlT3B0aW9uVmFsdWVNZXNzYWdlKCdtaW5sZW5ndGgnLCAnbWlubGVuZ3RoJywgJycsICdpcyB0aGUgbWluaW11bSBsZW5ndGgnLCAnVG9vIHNob3J0Jyk7XG4gICAgICBmb3JtbHlWYWxpZGF0aW9uTWVzc2FnZXMubWVzc2FnZXMucmVxdWlyZWQgPSAndG8ubGFiZWwgKyBcIiBpcyByZXF1aXJlZFwiJztcbiAgICAgIGZvcm1seVZhbGlkYXRpb25NZXNzYWdlcy5tZXNzYWdlcy5lbWFpbCA9ICckdmlld1ZhbHVlICsgXCIgc2hvdWxkIGJlIGEgdmFsaWQgZW1haWwgYWRkcmVzc1wiJztcbiAgICAgIC8vZm9ybWx5VmFsaWRhdGlvbk1lc3NhZ2VzLmFkZFN0cmluZ01lc3NhZ2UoJ21heGxlbmd0aCcsICcnKTtcblxuICAgICAgdm9pZCAwO1xuICAgICAgdm9pZCAwO1xuICAgIH0pO1xuXG4gIGZ1bmN0aW9uIHN0YXRlQ29uZmlnKCRzdGF0ZVByb3ZpZGVyKXtcbiAgICAkc3RhdGVQcm92aWRlclxuICBcdC5zdGF0ZSgnaG9tZScsIHsgLy8gc3RhdGUgZm9yIHNob3dpbmcgYWxsIG1vdmllc1xuICBcdFx0dXJsOiAnLycsXG4gIFx0XHR0ZW1wbGF0ZVVybDogJ2pzL3BhcnRpYWxzL2hvbWUuaHRtbCcsXG4gIFx0XHRjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzb2x2ZToge1xuXG4gICAgICB9XG4gIFx0fSlcbiAgICAuc3RhdGUoJ2Zvcm0nLCB7XG4gICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgIC8vdGVtcGxhdGU6ICc8dWktdmlldy8+JyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvZm9ybS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdGb3JtQ29udHJvbGxlcicsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICByZXNvbHZlOiB7XG5cbiAgICAgIH1cbiAgXHR9KVxuICAgIC5zdGF0ZSgnZm9ybS55b3VyLWRldGFpbHMnLCB7XG4gIFx0XHQvL3VybDogJy9mb3JtL2RldGFpbHMnLFxuICBcdFx0dGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy95b3VyLWRldGFpbHMuaHRtbCcsXG4gIFx0fSlcbiAgICAuc3RhdGUoJ2Zvcm0ueW91ci1vZmZlbmNlJywge1xuICBcdFx0Ly91cmw6ICcvZm9ybS9vZmZlbmNlJyxcbiAgXHRcdHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMveW91ci1vZmZlbmNlLmh0bWwnLFxuICBcdH0pXG4gICAgLnN0YXRlKCdmb3JtLmRlY2xhcmF0aW9uJywge1xuICBcdFx0Ly91cmw6ICcvZm9ybS9kZWNsYXJhdGlvbicsXG4gIFx0XHR0ZW1wbGF0ZVVybDogJ2pzL3BhcnRpYWxzL2RlY2xhcmF0aW9uLmh0bWwnLFxuICBcdH0pXG4gICAgLnN0YXRlKCdmb3JtLnJldmlldycsIHtcbiAgXHRcdC8vdXJsOiAnL2Zvcm0vcmV2aWV3JyxcbiAgXHRcdHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvcmV2aWV3Lmh0bWwnLFxuICBcdH0pXG4gICAgLnN0YXRlKCdmb3JtLmZpbmlzaCcsIHtcbiAgXHRcdHVybDogJy9zdWJtaXR0ZWQnLFxuICBcdFx0dGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9jb25maXJtYXRpb24uaHRtbCcsXG4gIFx0XHRjb250cm9sbGVyOiAnRm9ybUNvbmZpcm1hdGlvbkNvbnRyb2xsZXInLFxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgcmVzb2x2ZToge1xuICAgICAgfVxuICBcdH0pO1xuICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG4gIC8vIEFwcCBib290c3RyYXBwaW5nICsgRElcbiAgLypAbmdJbmplY3QqL1xuICBhbmd1bGFyLm1vZHVsZSgnbmpjT25saW5lUGxlYXMnKVxuICAgIC5jb250cm9sbGVyKCdDb25maXJtYXRpb25Gb3JtQ29udHJvbGxlcicsIENvbmZpcm1hdGlvbkZvcm1Db250cm9sbGVyKTtcblxuICAvKkBuZ0luamVjdCovXG4gIGZ1bmN0aW9uIENvbmZpcm1hdGlvbkZvcm1Db250cm9sbGVyKCRzY29wZSwgJGxvZywgJHJvb3RTY29wZSwgJHN0YXRlLCAkYWxlcnQsICR0b29sdGlwKXtcblxuICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICBmdW5jdGlvbiBpbml0KCl7XG4gICAgICB2b2lkIDA7XG4gICAgfVxuXG4gICAgaW5pdCgpO1xuICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG4gIC8vIEFwcCBib290c3RyYXBwaW5nICsgRElcbiAgLypAbmdJbmplY3QqL1xuICBhbmd1bGFyLm1vZHVsZSgnbmpjT25saW5lUGxlYXMnKVxuICAgIC5jb250cm9sbGVyKCdGb3JtQ29uZmlybWF0aW9uQ29udHJvbGxlcicsIEZvcm1Db25maXJtYXRpb25Db250cm9sbGVyKTtcblxuICAvKkBuZ0luamVjdCovXG4gIGZ1bmN0aW9uIEZvcm1Db25maXJtYXRpb25Db250cm9sbGVyKCRzY29wZSwgJGxvZywgJHJvb3RTY29wZSwgJHN0YXRlKXtcblxuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubW9kZWwgPSB7fTtcblxuICAgIGZ1bmN0aW9uIGluaXQoKXtcbiAgICAgIHZvaWQgMDtcbiAgICB9XG5cbiAgICBpbml0KCk7XG4gIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLmNvbnRyb2xsZXIoJ0Zvcm1Db250cm9sbGVyJywgRm9ybUNvbnRyb2xsZXIpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gRm9ybUNvbnRyb2xsZXIoJHNjb3BlLCAkbG9nLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRhbGVydCwgJG1vZGFsLCAkaHR0cCwgJGludGVydmFsLCAkc2NlKXtcblxuICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAvLyRsb2cubG9nKCRmb3JtbHlWYWxpZGF0aW9uTWVzc2FnZXMpO1xuXG4gICAgdm0uc3RlcHMgPSBbXG4gICAgICB7J2lkJzowLCAnbGFiZWwnOiAnWW91ciBkZXRhaWxzJ30sXG4gICAgICB7J2lkJzoxLCAnbGFiZWwnOiAnWW91ciBvZmZlbmNlJ30sXG4gICAgICB7J2lkJzoyLCAnbGFiZWwnOiAnRGVjbGFyYXRpb25zJ30sXG4gICAgICB7J2lkJzozLCAnbGFiZWwnOiAnUmV2aWV3J31cbiAgICBdO1xuXG4gICAgLy8gZGVmYXVsdCB0byB5b3VyIGRldGFpbHNcbiAgICB2bS5jdXJyZW50X3N0ZXBfaWQgPSAwO1xuXG4gICAgdm0ucGxhY2UgPSBudWxsO1xuICAgIHZtLmVycm9ycyA9IFtdO1xuXG4gICAgdm0uY2xlYW51cERhdGUgPSBmb3JtYXREYXRlRm9yQ291cnRsaW5rO1xuXG4gICAgdm0uY2FuY2VsRm9ybSA9IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgZXhpdE1vZGFsID0gJG1vZGFsKHtzY29wZTogJHNjb3BlLCBzaG93OiB0cnVlLCBjb250ZW50OiBcIkFyZSB5b3Ugc3VyZSB5b3Ugd291bGQgbGlrZSB0byBleGl0IHRoZSBmb3JtP1wiLCB0ZW1wbGF0ZVVybDogXCJqcy9wYXJ0aWFscy95ZXMtbm8tbW9kYWwuaHRtbFwifSk7XG5cbiAgICAgICRzY29wZS5leGl0Rm9ybSA9IGZ1bmN0aW9uKGNvbmZpcm0pe1xuICAgICAgICB2b2lkIDA7XG4gICAgICAgIGlmIChjb25maXJtKXtcbiAgICAgICAgICBleGl0TW9kYWwuaGlkZSgpO1xuICAgICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgICAgICAgICRzdGF0ZS5nbyhcImhvbWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZXhpdE1vZGFsLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgIH07XG5cbiAgICB2bS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgdmFyIGZpZWxkcyA9IGFuZ3VsYXIuY29weSh2bS5tb2RlbCk7XG4gICAgICBmaWVsZHMuYWRkcmVzcyA9IGNsZWFudXBHb29nbGVBZGRyZXNzKGZpZWxkcy5hZGRyZXNzKTtcbiAgICAgIGZpZWxkcy5wbGVhZF9ndWlsdHkgPSAoZmllbGRzLnBsZWFkX2d1aWx0eSkgPyBcIllFU1wiIDogXCJOT1wiO1xuICAgICAgZmllbGRzLmFja25vd2xlZGdlbWVudCA9IChmaWVsZHMuYWNrbm93bGVkZ2VtZW50KSA/IFwiWUVTXCIgOiBcIk5PXCI7XG4gICAgICAvL2ZpZWxkcy5iaXJ0aGRheSA9IGZvcm1hdERhdGVGb3JDb3VydGxpbmsodm0ubW9kZWwuYmlydGhkYXkpO1xuICAgICAgZmllbGRzLmJpcnRoZGF5ID0gdm0ubW9kZWwuYmlydGhkYXk7XG5cbiAgICAgICRodHRwLnBvc3QoXCJwbGVhc1wiLCBmaWVsZHMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgJHN0YXRlLmdvKCdmb3JtLmZpbmlzaCcpO1xuICAgICAgICB9LCBmdW5jdGlvbigpe1xuICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICBlcnJvcigpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZm9ybWF0RGF0ZUZvckNvdXJ0bGluayhkYXRlKXtcbiAgICAgIC8vIHRha2VzIGFuIG9iamVjdCB3aXRoIHt5ZWFyLCBtb250aCwgZGF5fSA9PiByZXR1cm5zIGEgZm9ybWF0dGVkIGRhdGVcbiAgICAgIC8vIHJldHVybiB0aGUgc2hvcnRmb3JtXG4gICAgICB2YXIgZCA9IG5ldyBEYXRlKGRhdGUueWVhciwgZGF0ZS5tb250aCwgZGF0ZS5kYXkpO1xuICAgICAgdmFyIG1vbnRobmFtZXMgPSBbXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJKdWx5XCIsIFwiQXVndXN0XCIsIFwiU2VwdGVtYmVyXCIsIFwiT2N0b2JlclwiLCBcIk5vdmVtYmVyXCIsIFwiRGVjZW1iZXJcIl07XG4gICAgICByZXR1cm4gZC5nZXREYXRlKCkgKyBcIiBcIiArIG1vbnRobmFtZXNbZC5nZXRNb250aCgpXS5zbGljZSgwLCAzKSArIFwiIFwiICsgZC5nZXRGdWxsWWVhcigpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvcm1hdERhdGVVbml4KGRhdGUpe1xuICAgICAgLy8gY29udmVydCB0aGUgZGF0ZSB0byBVTklYXG4gICAgICAvLyBleHBlY3QgMCBiYXNlZCBtb250aFxuICAgICAgZGF0ZS55ZWFyID0gKGRhdGUueWVhci5sZW5ndGggPT09IDIpID8gTnVtYmVyKFwiMjBcIitkYXRlLnllYXIpIDogZGF0ZS55ZWFyO1xuICAgICAgdmFyIGQgPSBuZXcgRGF0ZShkYXRlLnllYXIsIGRhdGUubW9udGgsIGRhdGUuZGF5KTtcbiAgICAgIHJldHVybiBkLmdldFRpbWUoKS8xMDAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvcm1hdERhdGVERE1NWVlZWShkYXRlLCBkZWxpbSl7XG4gICAgICB2YXIgZGVsaW1pdGVyID0gKGRlbGltKSA/IGRlbGltIDogXCIvXCI7XG4gICAgICAvLyBjb252ZXJ0IHRoZSBkYXRlIHRvIFlNRFxuICAgICAgLy8gZXhwZWN0IDAgYmFzZWQgbW9udGhcbiAgICAgIHZhciBkID0gbmV3IERhdGUoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoLCBkYXRlLmRheSk7XG4gICAgICB2YXIgbW9uID0gZC5nZXRNb250aCgpKzE7XG4gICAgICBtb24gPSBTdHJpbmcobW9uKS5sZW5ndGggPT09IDIgPyBtb24gOiBcIjBcIitTdHJpbmcobW9uKTtcbiAgICAgIHZhciBkYXkgPSBkLmdldERhdGUoKTtcbiAgICAgIGRheSA9IFN0cmluZyhkYXkpLmxlbmd0aCA9PT0gMiA/IGRheSA6IFwiMFwiK1N0cmluZyhkYXkpO1xuICAgICAgcmV0dXJuIGRheSArIGRlbGltaXRlciArIG1vbiArIGRlbGltaXRlciArIGQuZ2V0RnVsbFllYXIoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbGVhbnVwR29vZ2xlQWRkcmVzcyhhZGRyZXNzKXtcbiAgICAgIC8vIGV4dHJhY3QgdGhlIHBhcnRzIHdlIG5lZWQgZnJvbSB0aGUgZ29vZ2xlIGFkZHJlc3NcbiAgICAgIHJldHVybiBhZGRyZXNzLmZvcm1hdHRlZF9hZGRyZXNzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFudXBTcGxpdERhdGUoa2V5LCBtb2RlbCl7XG4gICAgICB2b2lkIDA7XG4gICAgICB2b2lkIDA7XG4gICAgICBpZiAoXG4gICAgICAgICFfLmlzVW5kZWZpbmVkKG1vZGVsKSAmJlxuICAgICAgICAhXy5pc1VuZGVmaW5lZChtb2RlbC5kYXkpICYmXG4gICAgICAgICFfLmlzVW5kZWZpbmVkKG1vZGVsLm1vbnRoKSAmJlxuICAgICAgICAhXy5pc1VuZGVmaW5lZChtb2RlbC55ZWFyKVxuICAgICAgKXtcbiAgICAgICAgdmFyIHltZCA9IHsgJ2RheSc6IG1vZGVsLmRheSB8fCAnJywgJ21vbnRoJzogbW9kZWwubW9udGggfHwgJycsICd5ZWFyJzogbW9kZWwueWVhciB8fCAnJyB9O1xuICAgICAgICByZXR1cm4gZm9ybWF0RGF0ZVlNRCh5bWQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qdm0uY2hlY2tCdXNpbmVzc1J1bGVzID0ge307XG4gICAgdm0uY2hlY2tCdXNpbmVzc1J1bGVzLnlvdXJfZGV0YWlscyA9IGZ1bmN0aW9uKCl7XG4gICAgICAvLyBtYWtlIHN1cmUgdGhlIGRvYiBpcyBhIHBhc3QgZGF0ZVxuICAgICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAgIGlmICh2bS5tb2RlbC55b3VyX2RldGFpbHMuYmlydGhkYXkgPj0gdG9kYXkpXG4gICAgICAgIHZtLmVycm9ycy5wdXNoKClcbiAgICB9OyovXG5cbiAgICB2bS5vcHRpb25zID0ge2RhdGE6e319O1xuICAgIHZtLm9wdGlvbnMuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZSA9IGdldFZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1lc3NhZ2Uoa2V5KSB7XG4gICAgICB2YXIgbWVzc2FnZSA9ICRzY29wZS5vcHRpb25zLnZhbGlkYXRpb24ubWVzc2FnZXNba2V5XTtcbiAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBtZXNzYWdlKCRzY29wZS5mYy4kdmlld1ZhbHVlLCAkc2NvcGUuZmMuJG1vZGVsVmFsdWUsICRzY29wZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdm0ucHJldiA9IGZ1bmN0aW9uKHByZXZfc3RlcCl7XG4gICAgICB2bS5lcnJvcnMgPSBbXTtcbiAgICAgIHZtLmN1cnJlbnRfc3RlcF9pZC0tO1xuICAgICAgJHN0YXRlLmdvKCdmb3JtLicrcHJldl9zdGVwLnJlcGxhY2UoXCJfXCIsIFwiLVwiKSk7XG4gICAgfTtcblxuICAgIHZtLm5leHQgPSBmdW5jdGlvbihjdXJyZW50X3N0ZXAsIG5leHRfc3RlcCl7XG4gICAgICB2bS5jaGVja1JlcXVpcmVkRmllbGRzKGN1cnJlbnRfc3RlcCk7XG4gICAgICAvL3ZtLmNoZWNrQnVzaW5lc3NSdWxlcyhjdXJyZW50X3N0ZXApO1xuICAgICAgdm9pZCAwO1xuICAgICAgLy8gY2hlY2sgdGhlIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgdm9pZCAwO1xuICAgICAgdm0uY2hlY2tSZXF1aXJlZEZpZWxkcyhjdXJyZW50X3N0ZXApO1xuICAgICAgaWYgKHZtLmVycm9ycy5sZW5ndGggPT09IDApe1xuICAgICAgICAkc3RhdGUuZ28oJ2Zvcm0uJytuZXh0X3N0ZXAucmVwbGFjZShcIl9cIiwgXCItXCIpKTtcbiAgICAgICAgdm0uY3VycmVudF9zdGVwX2lkKys7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHZtLmNoZWNrUmVxdWlyZWRGaWVsZHMgPSBmdW5jdGlvbihzdGVwKXtcbiAgICAgIHZvaWQgMDtcbiAgICAgIHZtLmVycm9ycyA9IFtdO1xuICAgICAgdmFyIGZpZWxkcyA9IHZtLmZpZWxkc1tzdGVwXTtcblxuICAgICAgdm9pZCAwO1xuXG4gICAgICBpZiAoc3RlcCA9PT0gJ3lvdXJfZGV0YWlscycpe1xuICAgICAgICB2b2lkIDA7XG4gICAgICAgIHZhciBkID0gY2xlYW51cFNwbGl0RGF0ZSgnYmlydGhkYXknLCB2bS5tb2RlbC5iaXJ0aGRheSk7XG4gICAgICAgIGlmIChkKXtcblxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIC8vZmllbGRzLmJpcnRoZGF5LiRlcnJvcnM7XG4gICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICB2b2lkIDA7XG4gICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgIHZhciBiZCA9IF8uZmluZCh2bS5maWVsZHMueW91cl9kZXRhaWxzLCB7J2tleSc6J2JpcnRoZGF5J30pO1xuICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICAvL2JkLiRlcnJvci5wYXN0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2b2lkIDA7XG4gICAgICBpZiAoc3RlcCAhPT0gJ2RlY2xhcmF0aW9uJyl7XG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICBpZiAoZmllbGQuZm9ybUNvbnRyb2wuJGludmFsaWQpe1xuICAgICAgICAgICAgdm0uZXJyb3JzLnB1c2goeydtZXNzYWdlJzogZmllbGQudGVtcGxhdGVPcHRpb25zLmxhYmVsICsgXCIgaXMgcmVxdWlyZWRcIn0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdmFyIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgZmllbGRzLmZvckVhY2goZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgIGlmIChmaWVsZC5mb3JtQ29udHJvbC4kaW52YWxpZClcbiAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjdXN0b20gZXJyb3IgbWVzc2FnZVxuICAgICAgICBpZiAoIXZhbGlkKVxuICAgICAgICAgIHZtLmVycm9ycy5wdXNoKHsnbWVzc2FnZSc6IFwiWW91IG11c3QgYWdyZWUgdG8gYm90aCBkZWNsYXJhdGlvbnMgdG8gcHJvY2VlZFwifSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHZtLmZpbmlzaCA9IGZ1bmN0aW9uKCl7XG4gICAgICB2b2lkIDA7XG4gICAgICAkc3RhdGUuZ28oXCJmb3JtLmZpbmlzaFwiKTtcbiAgICB9O1xuXG4gICAgdm0ubW9kZWwgPSB7XG4gICAgICB5b3VyX2RldGFpbHM6IHt9LFxuICAgICAgeW91cl9vZmZlbmNlOiB7fSxcbiAgICAgIGRlY2xhcmF0aW9uczoge30sXG4gICAgfTtcblxuICAgIHZtLm1vZGVsID0ge1xuICAgICAgY29udGFjdF9tZXRob2Q6IFwiZW1haWxcIiAvLyBkZWZhdWx0IGNvbnRhY3QgbWV0aG9kIHNob3VsZCBiZSBlbWFpbFxuICAgIH07XG5cbiAgICB2bS5zaG93TWlub3JPZmZlbmNlcyA9IGZ1bmN0aW9uKCl7XG4gICAgICB2b2lkIDA7XG4gICAgfTtcblxuICAgIHZtLmZpZWxkcyA9IHt9O1xuICAgIHZtLmZpZWxkcy55b3VyX2RldGFpbHMgPSBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdnaXZlbl9uYW1lJyxcbiAgICAgICAga2V5OiAnZ2l2ZW5fbmFtZScsXG4gICAgICAgIHR5cGU6ICdjdXN0b21JbnB1dCcsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIGxhYmVsOiAnR2l2ZW4gTmFtZShzKScsXG4gICAgICAgICAgLy9wbGFjZWhvbGRlcjogJ0VudGVyIHlvdXIgZ2l2ZW4gbmFtZShzKScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2ZhbWlseV9uYW1lJyxcbiAgICAgICAga2V5OiAnZmFtaWx5X25hbWUnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tSW5wdXQnLFxuICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICBsYWJlbDogJ0ZhbWlseSBOYW1lJyxcbiAgICAgICAgICAvL3BsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBmYW1pbHkgbmFtZScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2FkZHJlc3MnLFxuICAgICAgICBrZXk6ICdhZGRyZXNzJyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbUlucHV0JyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdSZXNpZGVudGlhbCBhZGRyZXNzJyxcbiAgICAgICAgICAvL3BsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBhZGRyZXNzJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAnZy1wbGFjZXMtYXV0b2NvbXBsZXRlJzonZy1wbGFjZXMtYXV0b2NvbXBsZXRlJ1xuICAgICAgICB9LFxuICAgICAgICBuZ01vZGVsQXR0cnM6IHtcbiAgICAgICAgICAnZy1wbGFjZXMtYXV0b2NvbXBsZXRlJzoge2F0dHJpYnV0ZTogJ2ctcGxhY2VzLWF1dG9jb21wbGV0ZSd9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnYmlydGhkYXknLFxuICAgICAgICBrZXk6ICdiaXJ0aGRheScsXG4gICAgICAgIC8vdHlwZTogJ2N1c3RvbUlucHV0JyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbUlucHV0JyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdEYXRlIG9mIEJpcnRoJyxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogJ2RkL21tL3l5eXknLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIHBhc3Q6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgdmFsaWRhdG9yczoge1xuICAgICAgICAgIHBhc3Q6IHtcbiAgICAgICAgICAgIGV4cHJlc3Npb246IGZ1bmN0aW9uKCR2aWV3VmFsdWUsICRtb2RlbFZhbHVlLCBzY29wZSl7XG4gICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICRtb2RlbFZhbHVlIHx8ICR2aWV3VmFsdWU7XG4gICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgdmFyIHltZCA9IHZhbHVlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgICAgICBpZiAoeW1kLmxlbmd0aCA9PSAzKXtcbiAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgIHltZCA9IGZvcm1hdERhdGVVbml4KHsgZGF5OiB5bWRbMF0sIG1vbnRoOiB5bWRbMV0tMSwgeWVhcjogeW1kWzJdIH0pO1xuICAgICAgICAgICAgICAgICAgdmFyIHRvZGF5ID0gZm9ybWF0RGF0ZVVuaXgoeyBkYXk6IGQuZ2V0RGF0ZSgpICwgbW9udGg6IGQuZ2V0TW9udGgoKSwgeWVhcjogZC5nZXRGdWxsWWVhcigpIH0pO1xuICAgICAgICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgaWYgKHRvZGF5ID4geW1kKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdcIkRhdGUgb2YgYmlydGggbXVzdCBiZSBhIHBhc3QgZGF0ZVwiJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2NvbnRhY3RfbWV0aG9kJyxcbiAgICAgICAga2V5OiAnY29udGFjdF9tZXRob2QnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tU2VsZWN0JyxcbiAgICAgICAgLy93cmFwcGVyOiBbJ2N1c3RvbUxhYmVsJywgJ2N1c3RvbUhhc0Vycm9yJ10sXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIGxhYmVsOiAnUHJlZmVycmVkIGNvbnRhY3QnLFxuICAgICAgICAgIC8vcGxhY2Vob2xkZXI6ICdzZWxlY3QgYSBwcmVmZXJyZWQgY29udGFjdCBtZXRob2QnLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIG9wdGlvbnM6IFtcbiAgICAgICAgICAgIHtuYW1lOiBcIlBob25lIG51bWJlclwiLCB2YWx1ZTogXCJwaG9uZVwifSwge25hbWU6IFwiRW1haWxcIiwgdmFsdWU6IFwiZW1haWxcIn1cbiAgICAgICAgICBdLFxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnY29udGFjdCcsXG4gICAgICAgIGtleTogJ2NvbnRhY3QnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tSW5wdXQnLFxuICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICBsYWJlbDogJ0NvbnRhY3QnLCAvLyBtYWtlIHRoaXMgbGFiZWwgZHluYW1pY1xuICAgICAgICAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBjb250YWN0JyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBleHByZXNzaW9uUHJvcGVydGllczoge1xuICAgICAgICAgICd0ZW1wbGF0ZU9wdGlvbnMubGFiZWwnOiAnXCJDb250YWN0IFwiICsgbW9kZWwuY29udGFjdF9tZXRob2QnXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgXTtcblxuICAgIHZtLmZpZWxkcy55b3VyX29mZmVuY2UgPSBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdoZWFyaW5nX2RhdGUnLFxuICAgICAgICBrZXk6ICdoZWFyaW5nX2RhdGUnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tSW5wdXQnLFxuICAgICAgICB3cmFwcGVyOiAnbm90ZScsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIGxhYmVsOiAnRGF0ZSBvZiB5b3VyIGhlYXJpbmcnLFxuICAgICAgICAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgdGhlIGRhdGUgb2YgeW91ciBoZWFyaW5nJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAnYnMtZGF0ZXBpY2tlcic6ICdicy1kYXRlcGlja2VyJyxcbiAgICAgICAgICBmb3JtX2ZpZWxkX25vdGU6J1RoaXMgZGF0ZSBpcyBsb2NhdGVkIG9uIHlvdXIgc3VtbW9ucyBkb2N1bWVudCBpbiB0aGUgc2VjdGlvbiBcIldoZXJlIHdpbGwgdGhlIGNhc2UgYmUgaGVhcmQ/XCInLFxuICAgICAgICAgIGZ1dHVyZTogdHJ1ZSxcbiAgICAgICAgICAvLydkYXRhLXRlbXBsYXRlLXVybCc6J2pzL3BhcnRpYWxzL2ZpZWxkLWhlYXJpbmctZGF0ZS1ub3RlLmh0bWwnLFxuICAgICAgICB9LFxuICAgICAgICBuZ01vZGVsQXR0cnM6IHtcbiAgICAgICAgICAnYnMtZGF0ZXBpY2tlcic6IHthdHRyaWJ1dGU6ICdicy1kYXRlcGlja2VyJ30sXG4gICAgICAgICAgJ2Zvcm0tZmllbGQtbm90ZSc6IHthdHRyaWJ1dGU6ICdmb3JtLWZpZWxkLW5vdGUnfVxuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3JzOiB7XG4gICAgICAgICAgZnV0dXJlOiB7XG4gICAgICAgICAgICBleHByZXNzaW9uOiBmdW5jdGlvbigkdmlld1ZhbHVlLCAkbW9kZWxWYWx1ZSwgc2NvcGUpe1xuICAgICAgICAgICAgICB2YXIgdmFsdWUgPSAkbW9kZWxWYWx1ZSB8fCAkdmlld1ZhbHVlO1xuICAgICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgIHZhciB5bWQgPSB2YWx1ZS5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICAgICAgaWYgKHltZC5sZW5ndGggPT0gMyl7XG4gICAgICAgICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICB5bWQgPSBmb3JtYXREYXRlVW5peCh7IGRheTogeW1kWzBdLCBtb250aDogeW1kWzFdLTEsIHllYXI6IHltZFsyXSB9KTtcbiAgICAgICAgICAgICAgICAgIHZhciB0b2RheSA9IGZvcm1hdERhdGVVbml4KHsgZGF5OiBkLmdldERhdGUoKSAsIG1vbnRoOiBkLmdldE1vbnRoKCksIHllYXI6IGQuZ2V0RnVsbFllYXIoKSB9KTtcbiAgICAgICAgICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgIGlmICh0b2RheSA8IHltZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXNzYWdlOiAnXCJEYXRlIG9mIHlvdXIgaGVhcmluZyBtdXN0IGJlIGEgZnV0dXJlIGRhdGVcIidcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdvZmZlbmNlX2RhdGUnLFxuICAgICAgICBrZXk6ICdvZmZlbmNlX2RhdGUnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tSW5wdXQnLFxuICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICBsYWJlbDogJ0RhdGUgb2YgeW91ciBvZmZlbmNlJyxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogJ0VudGVyIHRoZSBkYXRlIHlvdXIgb2ZmZW5jZSB3YXMgY29tbWl0dGVkJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAnYnMtZGF0ZXBpY2tlcic6ICdicy1kYXRlcGlja2VyJyxcbiAgICAgICAgICBwYXN0OiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIG5nTW9kZWxBdHRyczoge1xuICAgICAgICAgICdicy1kYXRlcGlja2VyJzoge1xuICAgICAgICAgICAgYXR0cmlidXRlOiAnYnMtZGF0ZXBpY2tlcidcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHZhbGlkYXRvcnM6IHtcbiAgICAgICAgICBwYXN0OiB7XG4gICAgICAgICAgICBleHByZXNzaW9uOiBmdW5jdGlvbigkdmlld1ZhbHVlLCAkbW9kZWxWYWx1ZSwgc2NvcGUpe1xuICAgICAgICAgICAgICB2YXIgdmFsdWUgPSAkbW9kZWxWYWx1ZSB8fCAkdmlld1ZhbHVlO1xuICAgICAgICAgICAgICB2b2lkIDA7XG4gICAgICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgICB2b2lkIDA7XG4gICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgdmFyIHltZCA9IHZhbHVlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgICAgICBpZiAoeW1kLmxlbmd0aCA9PSAzKXtcbiAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgIHltZCA9IGZvcm1hdERhdGVVbml4KHsgZGF5OiB5bWRbMF0sIG1vbnRoOiB5bWRbMV0tMSwgeWVhcjogeW1kWzJdIH0pO1xuICAgICAgICAgICAgICAgICAgdmFyIHRvZGF5ID0gZm9ybWF0RGF0ZVVuaXgoeyBkYXk6IGQuZ2V0RGF0ZSgpICwgbW9udGg6IGQuZ2V0TW9udGgoKSwgeWVhcjogZC5nZXRGdWxsWWVhcigpIH0pO1xuICAgICAgICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgaWYgKHRvZGF5ID4geW1kKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdcIkRhdGUgb2YgeW91ciBvZmZlbmNlIG11c3QgYmUgYSBwYXN0IGRhdGVcIidcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdvZmZlbmNlX2RldGFpbHMnLFxuICAgICAgICBrZXk6ICdvZmZlbmNlX2RldGFpbHMnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tVGV4dGFyZWEnLFxuICAgICAgICB3cmFwcGVyOiAnbm90ZU1vZGFsJyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdEZXRhaWxzIG9mIHlvdXIgb2ZmZW5jZShzKScsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciB0aGUgZGV0YWlscyBvZiB5b3VyIG9mZmVuY2UocykgYXMgZGVzY3JpYmVkIG9uIHlvdXIgc3VtbW9ucyBub3RpY2UnLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIG1vZGFsX3VybDogJ2pzL3BhcnRpYWxzL21pbm9yLW9mZmVuY2VzLmh0bWwnLFxuICAgICAgICAgIGZvcm1fZmllbGRfbm90ZTogJ09mZmVuY2VzIGZvciB3aGljaCB5b3UgY2FuIHN1Ym1pdCBhIHBsZWEgb25saW5lJ1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnbWVzc2FnZScsXG4gICAgICAgIGtleTogJ21lc3NhZ2UnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tVGV4dGFyZWFXaXRoQ291bnRlcicsXG4gICAgICAgIHdyYXBwZXI6ICdub3RlJyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdNZXNzYWdlIHRvIHRoZSBNYWdpc3RyYXRlJyxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogJ0VudGVyIGEgbWVzc2FnZSB0byBiZSBzZW50IHRvIHRoZSBtYWdpc3RyYXRlJyxcbiAgICAgICAgICBtYXhsZW5ndGg6IDYwMCxcbiAgICAgICAgICBwcmVwZW5kOiBcIlRoaXMgbWlnaHQgaW5jbHVkZSBleHBsYWluaW5nIHdoeSB5b3Ugb2ZmZW5kZWQsIHlvdXIgcGVyc29uYWwgb3IgZmluYW5jaWFsIGNpcmN1bXN0YW5jZXMsIGFuZCB0aGluZ3MgeW91IHdvdWxkIGxpa2UgdGhlIG1hZ2lzdHJhdGUgdG8gY29uc2lkZXIgd2hlbiBkZWNpZGluZyB5b3VyIHNlbnRlbmNlIFwiLFxuICAgICAgICAgIG1vZGFsX3VybDogXCJqcy9wYXJ0aWFscy9pbmZvcm1hdGlvbi1mb3ItdGhlLW1hZ2lzdHJhdGUuaHRtbFwiLFxuICAgICAgICAgIGZvcm1fZmllbGRfbm90ZTogJ3Nob3cgbW9yZSdcbiAgICAgICAgfSxcbiAgICAgICAgbmdNb2RlbEF0dHJzOiB7XG4gICAgICAgICAgZm9ybV9maWVsZF9ub3RlOiB7YXR0cmlidXRlOiAnZm9ybS1maWVsZC1ub3RlJ31cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgJHNjb3BlLmxvYWRNb2RhbCA9IGZ1bmN0aW9uKG1vZGFsKXtcbiAgICAgIHZhciBwYXRoID0gXCJqcy9wYXJ0aWFscy9cIjtcbiAgICAgIHZvaWQgMDtcbiAgICB9O1xuXG4gICAgdm0uZmllbGRzLmRlY2xhcmF0aW9uID0gW1xuICAgICAge1xuICAgICAgICBuYW1lOiAnYWNrbm93bGVkZ2VtZW50JyxcbiAgICAgICAga2V5OiAnYWNrbm93bGVkZ2VtZW50JyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbUNoZWNrYm94JyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbm9fbGFiZWw6IHRydWUsXG4gICAgICAgICAgbGFiZWw6ICdJIGFja25vd2xlZGdlIEkgbWF5IHBsZWFkIGd1aWx0eSBvciBub3QgZ3VpbHR5LiBJIGFja25vd2xlZGdlIG5vIHBvbGljZSBvZmZpY2VyIG9yIG90aGVyIHBlcnNvbiB0b2xkIG1lIHRvIHBsZWFkIGd1aWx0eScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ3BsZWFkX2d1aWx0eScsXG4gICAgICAgIGtleTogJ3BsZWFkX2d1aWx0eScsXG4gICAgICAgIHR5cGU6ICdjdXN0b21DaGVja2JveCcsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIG5vX2xhYmVsOiB0cnVlLFxuICAgICAgICAgIGxhYmVsOiAnSSBwbGVhZCBndWlsdHkgdG8gdGhlIG9mZmVuY2UocykgbGlzdGVkIGluIHRoaXMgZm9ybS4gVGhpcyBwbGVhIGlzIGVudGVyZWQgdm9sdW50YXJpbHkgb2YgbXkgb3duIGZyZWUgd2lsbCcsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF07XG5cblxuICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpe1xuICAgICAgdm0uZXJyb3JzID0ge307XG4gICAgICB2bS5tb2RlbCA9IHt9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yKCl7XG4gICAgICB2b2lkIDA7XG4gICAgICAkYWxlcnQoe1xuICAgICAgICB0aXRsZTogJ0hvbHkgZ3VhY2Ftb2xlIScsXG4gICAgICAgIGNvbnRlbnQ6ICdCZXN0IGNoZWNrIHlvIHNlbGYsIHlvdVxcJ3JlIG5vdCBsb29raW5nIHRvbyBnb29kLicsXG4gICAgICAgIHR5cGU6ICdkYW5nZXInLFxuICAgICAgICBzaG93OiBmYWxzZSxcbiAgICAgICAgY29udGFpbmVyOiBcIiNhbGVydC1jb250YWluZXJcIixcbiAgICAgICAgZHVyYXRpb246IDI1MDAsXG4gICAgICAgIGRpc21pc3NhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKGNhbGxiYWNrKXtcbiAgICAgIHZvaWQgMDtcbiAgICAgICRhbGVydCh7XG4gICAgICAgIHRpdGxlOiAnSG9seSBndWFjYW1vbGUhJyxcbiAgICAgICAgY29udGVudDogJ0Jlc3QgY2hlY2sgeW8gc2VsZiwgeW91XFwncmUgbm90IGxvb2tpbmcgdG9vIGdvb2QuJyxcbiAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgICBzaG93OiB0cnVlLFxuICAgICAgICBwbGFjZW1lbnQ6ICcnLFxuICAgICAgICBjb250YWluZXI6IFwiI2FsZXJ0LWNvbnRhaW5lclwiLFxuICAgICAgICBkdXJhdGlvbjogNSxcbiAgICAgICAgZGlzbWlzc2FibGU6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKXtcbiAgICAgIHZvaWQgMDtcbiAgICB9XG5cbiAgICBpbml0KCk7XG4gIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgSG9tZUNvbnRyb2xsZXIpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gSG9tZUNvbnRyb2xsZXIoJHNjb3BlLCAkbG9nLCAkcm9vdFNjb3BlLCAkc3RhdGUpe1xuXG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5tb2RlbCA9IHt9O1xuXG4gICAgdm0ubG9naW4gPSBmdW5jdGlvbigpe1xuICAgICAgdm9pZCAwO1xuICAgICAgdm9pZCAwO1xuICAgICAgdm9pZCAwO1xuICAgICAgJHN0YXRlLmdvKFwidmlld2VyXCIpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBpbml0KCl7XG4gICAgICB2b2lkIDA7XG4gICAgfVxuXG4gICAgaW5pdCgpO1xuICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG4gIC8vIEFwcCBib290c3RyYXBwaW5nICsgRElcbiAgLypAbmdJbmplY3QqL1xuICBhbmd1bGFyLm1vZHVsZSgnbmpjT25saW5lUGxlYXMnKVxuICAgIC5jb250cm9sbGVyKCdZZXNOb01vZGFsQ29udHJvbGxlcicsIFllc05vTW9kYWxDb250cm9sbGVyKTtcblxuICAvKkBuZ0luamVjdCovXG4gIGZ1bmN0aW9uIFllc05vTW9kYWxDb250cm9sbGVyKCRzY29wZSwgJGxvZyl7XG5cbiAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgZnVuY3Rpb24gaW5pdCgpe1xuICAgICAgdm9pZCAwO1xuICAgIH1cblxuICAgIGluaXQoKTtcbiAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKXtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyBBcHAgYm9vdHN0cmFwcGluZyArIERJXG4gIC8qQG5nSW5qZWN0Ki9cbiAgYW5ndWxhci5tb2R1bGUoJ25qY09ubGluZVBsZWFzJylcbiAgICAuZGlyZWN0aXZlKCdmb3JtU3RlcHMnLCBmdW5jdGlvbigkbG9nKXtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiBcIkVBXCIsIC8vIGVsZW1lbnQgb3IgYXR0cmlidXRlIG9ubHlcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSwgLy8gcmVwbGFjZSB0aGUgZWxlbWVudFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL3BhcnRpYWxzL2Zvcm0tc3RlcHMuZGlyZWN0aXZlLmh0bWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICdzdGVwcyc6ICc9JyxcbiAgICAgICAgICAnY3VycmVudCc6ICc9J1xuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cnMpe1xuICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICB2b2lkIDA7XG4gICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcblxufSkoKTtcblxuKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gIC5kaXJlY3RpdmUoJ2Zvcm1seUVycm9yU3VtbWFyeScsIGZ1bmN0aW9uKCRsb2cpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2NvcGU6IHt9LFxuICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuICAgICAgICBmb3JtOiAnPScsXG4gICAgICAgIGZpZWxkczogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3JtbHktZXJyb3Itc3VtbWFyeS5kaXJlY3RpdmUuaHRtbCcsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5nZXRFcnJvckFzTGlzdCA9IGdldEVycm9yQXNMaXN0O1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVycm9yQXNMaXN0KGZpZWxkKSB7XG4gICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGZpZWxkLmZvcm1Db250cm9sLiRlcnJvcikubWFwKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBub3RlLCB0aGlzIG9ubHkgd29ya3MgYmVjYXVzZSB0aGUgY3VzdG9tSW5wdXQgdHlwZSB3ZSBoYXZlIGRlZmluZWQuXG4gICAgICAgICAgICByZXR1cm4gZmllbGQuZGF0YS5nZXRWYWxpZGF0aW9uTWVzc2FnZShlcnJvcik7XG4gICAgICAgICAgfSkuam9pbignLCAnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH0pO1xuXG59KSgpO1xuXG4oZnVuY3Rpb24oKXtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyBBcHAgYm9vdHN0cmFwcGluZyArIERJXG4gIC8qQG5nSW5qZWN0Ki9cbiAgYW5ndWxhci5tb2R1bGUoJ25qY09ubGluZVBsZWFzJylcbiAgICAuZGlyZWN0aXZlKCdyYXRpbmcnLCBmdW5jdGlvbiAoJGxvZykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiRUFcIiwgLy8gZWxlbWVudCBvciBhdHRyaWJ1dGUgb25seVxuICAgICAgICByZXBsYWNlOiB0cnVlLCAvLyByZXBsYWNlIHRoZSBlbGVtZW50XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvcmF0aW5nLmRpcmVjdGl2ZS5odG1sJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRsb2csIFJhdGluZ1NlcnZpY2Upe1xuICAgICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgICAgdm9pZCAwO1xuXG4gICAgICAgICAgdm0uc3VibWl0dGVkID0gZmFsc2U7XG5cbiAgICAgICAgICB2bS5tb2RlbCA9IHt9O1xuICAgICAgICAgIHZtLnJhdGluZ19vcHRpb25zID0gW1xuICAgICAgICAgICAge1wibGFiZWxcIjogMSwgXCJ2YWx1ZVwiOiAxLCBcInZhbHVlX3RleHRcIjogXCJWZXJ5IGRpZmZpY3VsdFwifSxcbiAgICAgICAgICAgIHtcImxhYmVsXCI6IDIsIFwidmFsdWVcIjogMn0sXG4gICAgICAgICAgICB7XCJsYWJlbFwiOiAzLCBcInZhbHVlXCI6IDN9LFxuICAgICAgICAgICAge1wibGFiZWxcIjogNCwgXCJ2YWx1ZVwiOiA0fSxcbiAgICAgICAgICAgIHtcImxhYmVsXCI6IDUsIFwidmFsdWVcIjogNX0sXG4gICAgICAgICAgICB7XCJsYWJlbFwiOiA2LCBcInZhbHVlXCI6IDZ9LFxuICAgICAgICAgICAge1wibGFiZWxcIjogNywgXCJ2YWx1ZVwiOiA3LCBcInZhbHVlX3RleHRcIjogXCJWZXJ5IGVhc3lcIn1cbiAgICAgICAgICBdO1xuXG4gICAgICAgICAgdm0uZmllbGRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0eXBlOiAnY3VzdG9tUmF0aW5nUmFkaW8nLFxuICAgICAgICAgICAgICBrZXk6ICdyYXRpbmcnLFxuICAgICAgICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBsYWJlbDogXCJPdmVyYWxsLCBob3cgZGlmZmljdWx0IG9yIGVhc3kgZGlkIHlvdSBmaW5kIHRoaXMgdGFzaz9cIixcbiAgICAgICAgICAgICAgICBsYWJlbFByb3A6ICdsYWJlbCcsXG4gICAgICAgICAgICAgICAgdmFsdWVQcm9wOiAndmFsdWUnLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHZtLnJhdGluZ19vcHRpb25zXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR5cGU6ICd0ZXh0YXJlYScsXG4gICAgICAgICAgICAgIGtleTogJ2NvbW1lbnRzJyxcbiAgICAgICAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgbGFiZWw6IFwiQ29tbWVudHNcIixcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogZmFsc2VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF07XG5cbiAgICAgICAgICB2bS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgUmF0aW5nU2VydmljZVxuICAgICAgICAgICAgICAuY3JlYXRlKHZtLm1vZGVsKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICB2bS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHJzKXtcbiAgICAgICAgICB2b2lkIDA7XG4gICAgICAgICAgdm9pZCAwO1xuICAgICAgICAgIHZvaWQgMDtcbiAgICAgICAgICB2b2lkIDA7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSk7XG5cbn0pKCk7XG5cbi8vIER1bW15IGRhdGEgc2VydmljZVxuKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKm5nSW5qZWN0Ki9cbiAgYW5ndWxhci5tb2R1bGUoJ25qY09ubGluZVBsZWFzJylcbiAgICAuc2VydmljZSgnUmF0aW5nU2VydmljZScsIFJhdGluZ1NlcnZpY2UpO1xuXG4gIC8qbmdJbmplY3QqL1xuICBmdW5jdGlvbiBSYXRpbmdTZXJ2aWNlKCRsb2csICRodHRwKXtcblxuICAgIHJldHVybiB7XG4gICAgICBjcmVhdGU6IGZ1bmN0aW9uKHJhdGluZyl7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdyYXRpbmdzJywgcmF0aW5nKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLmNvbnRyb2xsZXIoJ0NvbmZpcm1hdGlvbkZvcm1Db250cm9sbGVyJywgQ29uZmlybWF0aW9uRm9ybUNvbnRyb2xsZXIpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gQ29uZmlybWF0aW9uRm9ybUNvbnRyb2xsZXIoJHNjb3BlLCAkbG9nLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRhbGVydCwgJHRvb2x0aXApe1xuXG4gICAgdmFyIHZtID0gdGhpcztcblxuICAgIGZ1bmN0aW9uIGluaXQoKXtcbiAgICAgICRsb2cubG9nKFwiTG9hZGVkIHRoZSBDb25maXJtYXRpb25Gb3JtQ29udHJvbGxlclwiKTtcbiAgICB9XG5cbiAgICBpbml0KCk7XG4gIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG4gIC8vIEFwcCBib290c3RyYXBwaW5nICsgRElcbiAgLypAbmdJbmplY3QqL1xuICBhbmd1bGFyLm1vZHVsZSgnbmpjT25saW5lUGxlYXMnKVxuICAgIC5jb250cm9sbGVyKCdGb3JtQ29uZmlybWF0aW9uQ29udHJvbGxlcicsIEZvcm1Db25maXJtYXRpb25Db250cm9sbGVyKTtcblxuICAvKkBuZ0luamVjdCovXG4gIGZ1bmN0aW9uIEZvcm1Db25maXJtYXRpb25Db250cm9sbGVyKCRzY29wZSwgJGxvZywgJHJvb3RTY29wZSwgJHN0YXRlKXtcblxuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubW9kZWwgPSB7fTtcblxuICAgIGZ1bmN0aW9uIGluaXQoKXtcbiAgICAgICRsb2cubG9nKFwiTG9hZGVkIHRoZSBmb3JtIGNvbmZpcm1hdGlvbiBjb250cm9sbGVyXCIpO1xuICAgIH1cblxuICAgIGluaXQoKTtcbiAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLmNvbnRyb2xsZXIoJ0Zvcm1Db250cm9sbGVyJywgRm9ybUNvbnRyb2xsZXIpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gRm9ybUNvbnRyb2xsZXIoJHNjb3BlLCAkbG9nLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRhbGVydCwgJG1vZGFsLCAkaHR0cCwgJGludGVydmFsLCAkc2NlKXtcblxuICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAvLyRsb2cubG9nKCRmb3JtbHlWYWxpZGF0aW9uTWVzc2FnZXMpO1xuXG4gICAgdm0uc3RlcHMgPSBbXG4gICAgICB7J2lkJzowLCAnbGFiZWwnOiAnWW91ciBkZXRhaWxzJ30sXG4gICAgICB7J2lkJzoxLCAnbGFiZWwnOiAnWW91ciBvZmZlbmNlJ30sXG4gICAgICB7J2lkJzoyLCAnbGFiZWwnOiAnRGVjbGFyYXRpb25zJ30sXG4gICAgICB7J2lkJzozLCAnbGFiZWwnOiAnUmV2aWV3J31cbiAgICBdO1xuXG4gICAgLy8gZGVmYXVsdCB0byB5b3VyIGRldGFpbHNcbiAgICB2bS5jdXJyZW50X3N0ZXBfaWQgPSAwO1xuXG4gICAgdm0ucGxhY2UgPSBudWxsO1xuICAgIHZtLmVycm9ycyA9IFtdO1xuXG4gICAgdm0uY2xlYW51cERhdGUgPSBmb3JtYXREYXRlRm9yQ291cnRsaW5rO1xuXG4gICAgdm0uY2FuY2VsRm9ybSA9IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgZXhpdE1vZGFsID0gJG1vZGFsKHtzY29wZTogJHNjb3BlLCBzaG93OiB0cnVlLCBjb250ZW50OiBcIkFyZSB5b3Ugc3VyZSB5b3Ugd291bGQgbGlrZSB0byBleGl0IHRoZSBmb3JtP1wiLCB0ZW1wbGF0ZVVybDogXCJqcy9wYXJ0aWFscy95ZXMtbm8tbW9kYWwuaHRtbFwifSk7XG5cbiAgICAgICRzY29wZS5leGl0Rm9ybSA9IGZ1bmN0aW9uKGNvbmZpcm0pe1xuICAgICAgICAkbG9nLmxvZyhcIkNvbmZpcm1pbmdcIik7XG4gICAgICAgIGlmIChjb25maXJtKXtcbiAgICAgICAgICBleGl0TW9kYWwuaGlkZSgpO1xuICAgICAgICAgIHJlc2V0Rm9ybSgpO1xuICAgICAgICAgICRzdGF0ZS5nbyhcImhvbWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZXhpdE1vZGFsLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgIH07XG5cbiAgICB2bS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgdmFyIGZpZWxkcyA9IGFuZ3VsYXIuY29weSh2bS5tb2RlbCk7XG4gICAgICBmaWVsZHMuYWRkcmVzcyA9IGNsZWFudXBHb29nbGVBZGRyZXNzKGZpZWxkcy5hZGRyZXNzKTtcbiAgICAgIGZpZWxkcy5wbGVhZF9ndWlsdHkgPSAoZmllbGRzLnBsZWFkX2d1aWx0eSkgPyBcIllFU1wiIDogXCJOT1wiO1xuICAgICAgZmllbGRzLmFja25vd2xlZGdlbWVudCA9IChmaWVsZHMuYWNrbm93bGVkZ2VtZW50KSA/IFwiWUVTXCIgOiBcIk5PXCI7XG4gICAgICAvL2ZpZWxkcy5iaXJ0aGRheSA9IGZvcm1hdERhdGVGb3JDb3VydGxpbmsodm0ubW9kZWwuYmlydGhkYXkpO1xuICAgICAgZmllbGRzLmJpcnRoZGF5ID0gdm0ubW9kZWwuYmlydGhkYXk7XG5cbiAgICAgICRodHRwLnBvc3QoXCJwbGVhc1wiLCBmaWVsZHMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgJHN0YXRlLmdvKCdmb3JtLmZpbmlzaCcpO1xuICAgICAgICB9LCBmdW5jdGlvbigpe1xuICAgICAgICAgICRsb2cubG9nKFwiU2hvdyBhbiBlcnJvclwiKTtcbiAgICAgICAgICBlcnJvcigpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZm9ybWF0RGF0ZUZvckNvdXJ0bGluayhkYXRlKXtcbiAgICAgIC8vIHRha2VzIGFuIG9iamVjdCB3aXRoIHt5ZWFyLCBtb250aCwgZGF5fSA9PiByZXR1cm5zIGEgZm9ybWF0dGVkIGRhdGVcbiAgICAgIC8vIHJldHVybiB0aGUgc2hvcnRmb3JtXG4gICAgICB2YXIgZCA9IG5ldyBEYXRlKGRhdGUueWVhciwgZGF0ZS5tb250aCwgZGF0ZS5kYXkpO1xuICAgICAgdmFyIG1vbnRobmFtZXMgPSBbXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJKdWx5XCIsIFwiQXVndXN0XCIsIFwiU2VwdGVtYmVyXCIsIFwiT2N0b2JlclwiLCBcIk5vdmVtYmVyXCIsIFwiRGVjZW1iZXJcIl07XG4gICAgICByZXR1cm4gZC5nZXREYXRlKCkgKyBcIiBcIiArIG1vbnRobmFtZXNbZC5nZXRNb250aCgpXS5zbGljZSgwLCAzKSArIFwiIFwiICsgZC5nZXRGdWxsWWVhcigpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvcm1hdERhdGVVbml4KGRhdGUpe1xuICAgICAgLy8gY29udmVydCB0aGUgZGF0ZSB0byBVTklYXG4gICAgICAvLyBleHBlY3QgMCBiYXNlZCBtb250aFxuICAgICAgZGF0ZS55ZWFyID0gKGRhdGUueWVhci5sZW5ndGggPT09IDIpID8gTnVtYmVyKFwiMjBcIitkYXRlLnllYXIpIDogZGF0ZS55ZWFyO1xuICAgICAgdmFyIGQgPSBuZXcgRGF0ZShkYXRlLnllYXIsIGRhdGUubW9udGgsIGRhdGUuZGF5KTtcbiAgICAgIHJldHVybiBkLmdldFRpbWUoKS8xMDAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvcm1hdERhdGVERE1NWVlZWShkYXRlLCBkZWxpbSl7XG4gICAgICB2YXIgZGVsaW1pdGVyID0gKGRlbGltKSA/IGRlbGltIDogXCIvXCI7XG4gICAgICAvLyBjb252ZXJ0IHRoZSBkYXRlIHRvIFlNRFxuICAgICAgLy8gZXhwZWN0IDAgYmFzZWQgbW9udGhcbiAgICAgIHZhciBkID0gbmV3IERhdGUoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoLCBkYXRlLmRheSk7XG4gICAgICB2YXIgbW9uID0gZC5nZXRNb250aCgpKzE7XG4gICAgICBtb24gPSBTdHJpbmcobW9uKS5sZW5ndGggPT09IDIgPyBtb24gOiBcIjBcIitTdHJpbmcobW9uKTtcbiAgICAgIHZhciBkYXkgPSBkLmdldERhdGUoKTtcbiAgICAgIGRheSA9IFN0cmluZyhkYXkpLmxlbmd0aCA9PT0gMiA/IGRheSA6IFwiMFwiK1N0cmluZyhkYXkpO1xuICAgICAgcmV0dXJuIGRheSArIGRlbGltaXRlciArIG1vbiArIGRlbGltaXRlciArIGQuZ2V0RnVsbFllYXIoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbGVhbnVwR29vZ2xlQWRkcmVzcyhhZGRyZXNzKXtcbiAgICAgIC8vIGV4dHJhY3QgdGhlIHBhcnRzIHdlIG5lZWQgZnJvbSB0aGUgZ29vZ2xlIGFkZHJlc3NcbiAgICAgIHJldHVybiBhZGRyZXNzLmZvcm1hdHRlZF9hZGRyZXNzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFudXBTcGxpdERhdGUoa2V5LCBtb2RlbCl7XG4gICAgICAkbG9nLmxvZyhcIkNsZWFuIHVwIGZpZWxkIFwiICsga2V5ICsgXCIgd2l0aCBkYXRhIFwiKTtcbiAgICAgICRsb2cubG9nKG1vZGVsKTtcbiAgICAgIGlmIChcbiAgICAgICAgIV8uaXNVbmRlZmluZWQobW9kZWwpICYmXG4gICAgICAgICFfLmlzVW5kZWZpbmVkKG1vZGVsLmRheSkgJiZcbiAgICAgICAgIV8uaXNVbmRlZmluZWQobW9kZWwubW9udGgpICYmXG4gICAgICAgICFfLmlzVW5kZWZpbmVkKG1vZGVsLnllYXIpXG4gICAgICApe1xuICAgICAgICB2YXIgeW1kID0geyAnZGF5JzogbW9kZWwuZGF5IHx8ICcnLCAnbW9udGgnOiBtb2RlbC5tb250aCB8fCAnJywgJ3llYXInOiBtb2RlbC55ZWFyIHx8ICcnIH07XG4gICAgICAgIHJldHVybiBmb3JtYXREYXRlWU1EKHltZCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyp2bS5jaGVja0J1c2luZXNzUnVsZXMgPSB7fTtcbiAgICB2bS5jaGVja0J1c2luZXNzUnVsZXMueW91cl9kZXRhaWxzID0gZnVuY3Rpb24oKXtcbiAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgZG9iIGlzIGEgcGFzdCBkYXRlXG4gICAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgICAgaWYgKHZtLm1vZGVsLnlvdXJfZGV0YWlscy5iaXJ0aGRheSA+PSB0b2RheSlcbiAgICAgICAgdm0uZXJyb3JzLnB1c2goKVxuICAgIH07Ki9cblxuICAgIHZtLm9wdGlvbnMgPSB7ZGF0YTp7fX07XG4gICAgdm0ub3B0aW9ucy5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlID0gZ2V0VmFsaWRhdGlvbk1lc3NhZ2U7XG5cbiAgICBmdW5jdGlvbiBnZXRWYWxpZGF0aW9uTWVzc2FnZShrZXkpIHtcbiAgICAgIHZhciBtZXNzYWdlID0gJHNjb3BlLm9wdGlvbnMudmFsaWRhdGlvbi5tZXNzYWdlc1trZXldO1xuICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2UoJHNjb3BlLmZjLiR2aWV3VmFsdWUsICRzY29wZS5mYy4kbW9kZWxWYWx1ZSwgJHNjb3BlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2bS5wcmV2ID0gZnVuY3Rpb24ocHJldl9zdGVwKXtcbiAgICAgIHZtLmVycm9ycyA9IFtdO1xuICAgICAgdm0uY3VycmVudF9zdGVwX2lkLS07XG4gICAgICAkc3RhdGUuZ28oJ2Zvcm0uJytwcmV2X3N0ZXAucmVwbGFjZShcIl9cIiwgXCItXCIpKTtcbiAgICB9O1xuXG4gICAgdm0ubmV4dCA9IGZ1bmN0aW9uKGN1cnJlbnRfc3RlcCwgbmV4dF9zdGVwKXtcbiAgICAgIHZtLmNoZWNrUmVxdWlyZWRGaWVsZHMoY3VycmVudF9zdGVwKTtcbiAgICAgIC8vdm0uY2hlY2tCdXNpbmVzc1J1bGVzKGN1cnJlbnRfc3RlcCk7XG4gICAgICAkbG9nLmxvZyhcIk1vdmluZyB0bzogXCIgKyBuZXh0X3N0ZXApO1xuICAgICAgLy8gY2hlY2sgdGhlIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgJGxvZy5sb2codm0uZmllbGRzKTtcbiAgICAgIHZtLmNoZWNrUmVxdWlyZWRGaWVsZHMoY3VycmVudF9zdGVwKTtcbiAgICAgIGlmICh2bS5lcnJvcnMubGVuZ3RoID09PSAwKXtcbiAgICAgICAgJHN0YXRlLmdvKCdmb3JtLicrbmV4dF9zdGVwLnJlcGxhY2UoXCJfXCIsIFwiLVwiKSk7XG4gICAgICAgIHZtLmN1cnJlbnRfc3RlcF9pZCsrO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB2bS5jaGVja1JlcXVpcmVkRmllbGRzID0gZnVuY3Rpb24oc3RlcCl7XG4gICAgICAkbG9nLmxvZyhcIkNoZWNraW5nOiBcIiArIHN0ZXApO1xuICAgICAgdm0uZXJyb3JzID0gW107XG4gICAgICB2YXIgZmllbGRzID0gdm0uZmllbGRzW3N0ZXBdO1xuXG4gICAgICAkbG9nLmxvZyhmaWVsZHMpO1xuXG4gICAgICBpZiAoc3RlcCA9PT0gJ3lvdXJfZGV0YWlscycpe1xuICAgICAgICAkbG9nLmxvZyhcIkNIRUNLIEJEXCIpO1xuICAgICAgICB2YXIgZCA9IGNsZWFudXBTcGxpdERhdGUoJ2JpcnRoZGF5Jywgdm0ubW9kZWwuYmlydGhkYXkpO1xuICAgICAgICBpZiAoZCl7XG5cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAvL2ZpZWxkcy5iaXJ0aGRheS4kZXJyb3JzO1xuICAgICAgICAgICRsb2cubG9nKFwiRVJST1IgRk9VTkRcIik7XG4gICAgICAgICAgJGxvZy5sb2codm0uZm9ybSk7XG4gICAgICAgICAgJGxvZy5sb2codm0ubW9kZWwpO1xuICAgICAgICAgICRsb2cubG9nKHZtLmZpZWxkcyk7XG4gICAgICAgICAgdmFyIGJkID0gXy5maW5kKHZtLmZpZWxkcy55b3VyX2RldGFpbHMsIHsna2V5JzonYmlydGhkYXknfSk7XG4gICAgICAgICAgJGxvZy5sb2coYmQpO1xuICAgICAgICAgIC8vYmQuJGVycm9yLnBhc3QgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRsb2cubG9nKFwiQ0hFQ0sgQUxMIEZJRUxEU1wiKTtcbiAgICAgIGlmIChzdGVwICE9PSAnZGVjbGFyYXRpb24nKXtcbiAgICAgICAgZmllbGRzLmZvckVhY2goZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgIGlmIChmaWVsZC5mb3JtQ29udHJvbC4kaW52YWxpZCl7XG4gICAgICAgICAgICB2bS5lcnJvcnMucHVzaCh7J21lc3NhZ2UnOiBmaWVsZC50ZW1wbGF0ZU9wdGlvbnMubGFiZWwgKyBcIiBpcyByZXF1aXJlZFwifSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB2YXIgdmFsaWQgPSB0cnVlO1xuICAgICAgICBmaWVsZHMuZm9yRWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgaWYgKGZpZWxkLmZvcm1Db250cm9sLiRpbnZhbGlkKVxuICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGN1c3RvbSBlcnJvciBtZXNzYWdlXG4gICAgICAgIGlmICghdmFsaWQpXG4gICAgICAgICAgdm0uZXJyb3JzLnB1c2goeydtZXNzYWdlJzogXCJZb3UgbXVzdCBhZ3JlZSB0byBib3RoIGRlY2xhcmF0aW9ucyB0byBwcm9jZWVkXCJ9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdm0uZmluaXNoID0gZnVuY3Rpb24oKXtcbiAgICAgICRsb2cubG9nKFwiRklOSVNIRURcIik7XG4gICAgICAkc3RhdGUuZ28oXCJmb3JtLmZpbmlzaFwiKTtcbiAgICB9O1xuXG4gICAgdm0ubW9kZWwgPSB7XG4gICAgICB5b3VyX2RldGFpbHM6IHt9LFxuICAgICAgeW91cl9vZmZlbmNlOiB7fSxcbiAgICAgIGRlY2xhcmF0aW9uczoge30sXG4gICAgfTtcblxuICAgIHZtLm1vZGVsID0ge1xuICAgICAgY29udGFjdF9tZXRob2Q6IFwiZW1haWxcIiAvLyBkZWZhdWx0IGNvbnRhY3QgbWV0aG9kIHNob3VsZCBiZSBlbWFpbFxuICAgIH07XG5cbiAgICB2bS5zaG93TWlub3JPZmZlbmNlcyA9IGZ1bmN0aW9uKCl7XG4gICAgICAkbG9nLmxvZyhcIlNIT1cgTUlOT1IgT0ZGRU5DRVNcIik7XG4gICAgfTtcblxuICAgIHZtLmZpZWxkcyA9IHt9O1xuICAgIHZtLmZpZWxkcy55b3VyX2RldGFpbHMgPSBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdnaXZlbl9uYW1lJyxcbiAgICAgICAga2V5OiAnZ2l2ZW5fbmFtZScsXG4gICAgICAgIHR5cGU6ICdjdXN0b21JbnB1dCcsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIGxhYmVsOiAnR2l2ZW4gTmFtZShzKScsXG4gICAgICAgICAgLy9wbGFjZWhvbGRlcjogJ0VudGVyIHlvdXIgZ2l2ZW4gbmFtZShzKScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2ZhbWlseV9uYW1lJyxcbiAgICAgICAga2V5OiAnZmFtaWx5X25hbWUnLFxuICAgICAgICB0eXBlOiAnY3VzdG9tSW5wdXQnLFxuICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICBsYWJlbDogJ0ZhbWlseSBOYW1lJyxcbiAgICAgICAgICAvL3BsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBmYW1pbHkgbmFtZScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2FkZHJlc3MnLFxuICAgICAgICBrZXk6ICdhZGRyZXNzJyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbUlucHV0JyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdSZXNpZGVudGlhbCBhZGRyZXNzJyxcbiAgICAgICAgICAvL3BsYWNlaG9sZGVyOiAnRW50ZXIgeW91ciBhZGRyZXNzJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAnZy1wbGFjZXMtYXV0b2NvbXBsZXRlJzonZy1wbGFjZXMtYXV0b2NvbXBsZXRlJ1xuICAgICAgICB9LFxuICAgICAgICBuZ01vZGVsQXR0cnM6IHtcbiAgICAgICAgICAnZy1wbGFjZXMtYXV0b2NvbXBsZXRlJzoge2F0dHJpYnV0ZTogJ2ctcGxhY2VzLWF1dG9jb21wbGV0ZSd9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnYmlydGhkYXknLFxuICAgICAgICBrZXk6ICdiaXJ0aGRheScsXG4gICAgICAgIC8vdHlwZTogJ2N1c3RvbUlucHV0JyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbUlucHV0JyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdEYXRlIG9mIEJpcnRoJyxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogJ2RkL21tL3l5eXknLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIHBhc3Q6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgdmFsaWRhdG9yczoge1xuICAgICAgICAgIHBhc3Q6IHtcbiAgICAgICAgICAgIGV4cHJlc3Npb246IGZ1bmN0aW9uKCR2aWV3VmFsdWUsICRtb2RlbFZhbHVlLCBzY29wZSl7XG4gICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICRtb2RlbFZhbHVlIHx8ICR2aWV3VmFsdWU7XG4gICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgdmFyIHltZCA9IHZhbHVlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgICAgICBpZiAoeW1kLmxlbmd0aCA9PSAzKXtcbiAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICRsb2cubG9nKHltZCk7XG4gICAgICAgICAgICAgICAgICB5bWQgPSBmb3JtYXREYXRlVW5peCh7IGRheTogeW1kWzBdLCBtb250aDogeW1kWzFdLTEsIHllYXI6IHltZFsyXSB9KTtcbiAgICAgICAgICAgICAgICAgIHZhciB0b2RheSA9IGZvcm1hdERhdGVVbml4KHsgZGF5OiBkLmdldERhdGUoKSAsIG1vbnRoOiBkLmdldE1vbnRoKCksIHllYXI6IGQuZ2V0RnVsbFllYXIoKSB9KTtcbiAgICAgICAgICAgICAgICAgICRsb2cubG9nKHltZCk7XG4gICAgICAgICAgICAgICAgICAkbG9nLmxvZyh0b2RheSk7XG4gICAgICAgICAgICAgICAgICBpZiAodG9kYXkgPiB5bWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWVzc2FnZTogJ1wiRGF0ZSBvZiBiaXJ0aCBtdXN0IGJlIGEgcGFzdCBkYXRlXCInXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnY29udGFjdF9tZXRob2QnLFxuICAgICAgICBrZXk6ICdjb250YWN0X21ldGhvZCcsXG4gICAgICAgIHR5cGU6ICdjdXN0b21TZWxlY3QnLFxuICAgICAgICAvL3dyYXBwZXI6IFsnY3VzdG9tTGFiZWwnLCAnY3VzdG9tSGFzRXJyb3InXSxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdQcmVmZXJyZWQgY29udGFjdCcsXG4gICAgICAgICAgLy9wbGFjZWhvbGRlcjogJ3NlbGVjdCBhIHByZWZlcnJlZCBjb250YWN0IG1ldGhvZCcsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgb3B0aW9uczogW1xuICAgICAgICAgICAge25hbWU6IFwiUGhvbmUgbnVtYmVyXCIsIHZhbHVlOiBcInBob25lXCJ9LCB7bmFtZTogXCJFbWFpbFwiLCB2YWx1ZTogXCJlbWFpbFwifVxuICAgICAgICAgIF0sXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdjb250YWN0JyxcbiAgICAgICAga2V5OiAnY29udGFjdCcsXG4gICAgICAgIHR5cGU6ICdjdXN0b21JbnB1dCcsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIGxhYmVsOiAnQ29udGFjdCcsIC8vIG1ha2UgdGhpcyBsYWJlbCBkeW5hbWljXG4gICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciB5b3VyIGNvbnRhY3QnLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGV4cHJlc3Npb25Qcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgJ3RlbXBsYXRlT3B0aW9ucy5sYWJlbCc6ICdcIkNvbnRhY3QgXCIgKyBtb2RlbC5jb250YWN0X21ldGhvZCdcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgdm0uZmllbGRzLnlvdXJfb2ZmZW5jZSA9IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2hlYXJpbmdfZGF0ZScsXG4gICAgICAgIGtleTogJ2hlYXJpbmdfZGF0ZScsXG4gICAgICAgIHR5cGU6ICdjdXN0b21JbnB1dCcsXG4gICAgICAgIHdyYXBwZXI6ICdub3RlJyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdEYXRlIG9mIHlvdXIgaGVhcmluZycsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciB0aGUgZGF0ZSBvZiB5b3VyIGhlYXJpbmcnLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICdicy1kYXRlcGlja2VyJzogJ2JzLWRhdGVwaWNrZXInLFxuICAgICAgICAgIGZvcm1fZmllbGRfbm90ZTonVGhpcyBkYXRlIGlzIGxvY2F0ZWQgb24geW91ciBzdW1tb25zIGRvY3VtZW50IGluIHRoZSBzZWN0aW9uIFwiV2hlcmUgd2lsbCB0aGUgY2FzZSBiZSBoZWFyZD9cIicsXG4gICAgICAgICAgZnV0dXJlOiB0cnVlLFxuICAgICAgICAgIC8vJ2RhdGEtdGVtcGxhdGUtdXJsJzonanMvcGFydGlhbHMvZmllbGQtaGVhcmluZy1kYXRlLW5vdGUuaHRtbCcsXG4gICAgICAgIH0sXG4gICAgICAgIG5nTW9kZWxBdHRyczoge1xuICAgICAgICAgICdicy1kYXRlcGlja2VyJzoge2F0dHJpYnV0ZTogJ2JzLWRhdGVwaWNrZXInfSxcbiAgICAgICAgICAnZm9ybS1maWVsZC1ub3RlJzoge2F0dHJpYnV0ZTogJ2Zvcm0tZmllbGQtbm90ZSd9XG4gICAgICAgIH0sXG4gICAgICAgIHZhbGlkYXRvcnM6IHtcbiAgICAgICAgICBmdXR1cmU6IHtcbiAgICAgICAgICAgIGV4cHJlc3Npb246IGZ1bmN0aW9uKCR2aWV3VmFsdWUsICRtb2RlbFZhbHVlLCBzY29wZSl7XG4gICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICRtb2RlbFZhbHVlIHx8ICR2aWV3VmFsdWU7XG4gICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgdmFyIHltZCA9IHZhbHVlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgICAgICBpZiAoeW1kLmxlbmd0aCA9PSAzKXtcbiAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICRsb2cubG9nKHltZCk7XG4gICAgICAgICAgICAgICAgICB5bWQgPSBmb3JtYXREYXRlVW5peCh7IGRheTogeW1kWzBdLCBtb250aDogeW1kWzFdLTEsIHllYXI6IHltZFsyXSB9KTtcbiAgICAgICAgICAgICAgICAgIHZhciB0b2RheSA9IGZvcm1hdERhdGVVbml4KHsgZGF5OiBkLmdldERhdGUoKSAsIG1vbnRoOiBkLmdldE1vbnRoKCksIHllYXI6IGQuZ2V0RnVsbFllYXIoKSB9KTtcbiAgICAgICAgICAgICAgICAgICRsb2cubG9nKHltZCk7XG4gICAgICAgICAgICAgICAgICAkbG9nLmxvZyh0b2RheSk7XG4gICAgICAgICAgICAgICAgICBpZiAodG9kYXkgPCB5bWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWVzc2FnZTogJ1wiRGF0ZSBvZiB5b3VyIGhlYXJpbmcgbXVzdCBiZSBhIGZ1dHVyZSBkYXRlXCInXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnb2ZmZW5jZV9kYXRlJyxcbiAgICAgICAga2V5OiAnb2ZmZW5jZV9kYXRlJyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbUlucHV0JyxcbiAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgbGFiZWw6ICdEYXRlIG9mIHlvdXIgb2ZmZW5jZScsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciB0aGUgZGF0ZSB5b3VyIG9mZmVuY2Ugd2FzIGNvbW1pdHRlZCcsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgJ2JzLWRhdGVwaWNrZXInOiAnYnMtZGF0ZXBpY2tlcicsXG4gICAgICAgICAgcGFzdDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBuZ01vZGVsQXR0cnM6IHtcbiAgICAgICAgICAnYnMtZGF0ZXBpY2tlcic6IHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2JzLWRhdGVwaWNrZXInXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0b3JzOiB7XG4gICAgICAgICAgcGFzdDoge1xuICAgICAgICAgICAgZXhwcmVzc2lvbjogZnVuY3Rpb24oJHZpZXdWYWx1ZSwgJG1vZGVsVmFsdWUsIHNjb3BlKXtcbiAgICAgICAgICAgICAgdmFyIHZhbHVlID0gJG1vZGVsVmFsdWUgfHwgJHZpZXdWYWx1ZTtcbiAgICAgICAgICAgICAgJGxvZy5sb2coXCJPZmZlbmNlIGRhdGVcIik7XG4gICAgICAgICAgICAgICRsb2cubG9nKCRtb2RlbFZhbHVlKTtcbiAgICAgICAgICAgICAgJGxvZy5sb2coJHZpZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICRsb2cubG9nKHNjb3BlKTtcbiAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICB2YXIgeW1kID0gdmFsdWUuc3BsaXQoXCIvXCIpO1xuICAgICAgICAgICAgICAgIGlmICh5bWQubGVuZ3RoID09IDMpe1xuICAgICAgICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgJGxvZy5sb2coeW1kKTtcbiAgICAgICAgICAgICAgICAgIHltZCA9IGZvcm1hdERhdGVVbml4KHsgZGF5OiB5bWRbMF0sIG1vbnRoOiB5bWRbMV0tMSwgeWVhcjogeW1kWzJdIH0pO1xuICAgICAgICAgICAgICAgICAgdmFyIHRvZGF5ID0gZm9ybWF0RGF0ZVVuaXgoeyBkYXk6IGQuZ2V0RGF0ZSgpICwgbW9udGg6IGQuZ2V0TW9udGgoKSwgeWVhcjogZC5nZXRGdWxsWWVhcigpIH0pO1xuICAgICAgICAgICAgICAgICAgJGxvZy5sb2coeW1kKTtcbiAgICAgICAgICAgICAgICAgICRsb2cubG9nKHRvZGF5KTtcbiAgICAgICAgICAgICAgICAgIGlmICh0b2RheSA+IHltZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXNzYWdlOiAnXCJEYXRlIG9mIHlvdXIgb2ZmZW5jZSBtdXN0IGJlIGEgcGFzdCBkYXRlXCInXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnb2ZmZW5jZV9kZXRhaWxzJyxcbiAgICAgICAga2V5OiAnb2ZmZW5jZV9kZXRhaWxzJyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbVRleHRhcmVhJyxcbiAgICAgICAgd3JhcHBlcjogJ25vdGVNb2RhbCcsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIGxhYmVsOiAnRGV0YWlscyBvZiB5b3VyIG9mZmVuY2UocyknLFxuICAgICAgICAgIHBsYWNlaG9sZGVyOiAnRW50ZXIgdGhlIGRldGFpbHMgb2YgeW91ciBvZmZlbmNlKHMpIGFzIGRlc2NyaWJlZCBvbiB5b3VyIHN1bW1vbnMgbm90aWNlJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBtb2RhbF91cmw6ICdqcy9wYXJ0aWFscy9taW5vci1vZmZlbmNlcy5odG1sJyxcbiAgICAgICAgICBmb3JtX2ZpZWxkX25vdGU6ICdPZmZlbmNlcyBmb3Igd2hpY2ggeW91IGNhbiBzdWJtaXQgYSBwbGVhIG9ubGluZSdcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ21lc3NhZ2UnLFxuICAgICAgICBrZXk6ICdtZXNzYWdlJyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbVRleHRhcmVhV2l0aENvdW50ZXInLFxuICAgICAgICB3cmFwcGVyOiAnbm90ZScsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIGxhYmVsOiAnTWVzc2FnZSB0byB0aGUgTWFnaXN0cmF0ZScsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6ICdFbnRlciBhIG1lc3NhZ2UgdG8gYmUgc2VudCB0byB0aGUgbWFnaXN0cmF0ZScsXG4gICAgICAgICAgbWF4bGVuZ3RoOiA2MDAsXG4gICAgICAgICAgcHJlcGVuZDogXCJUaGlzIG1pZ2h0IGluY2x1ZGUgZXhwbGFpbmluZyB3aHkgeW91IG9mZmVuZGVkLCB5b3VyIHBlcnNvbmFsIG9yIGZpbmFuY2lhbCBjaXJjdW1zdGFuY2VzLCBhbmQgdGhpbmdzIHlvdSB3b3VsZCBsaWtlIHRoZSBtYWdpc3RyYXRlIHRvIGNvbnNpZGVyIHdoZW4gZGVjaWRpbmcgeW91ciBzZW50ZW5jZSBcIixcbiAgICAgICAgICBtb2RhbF91cmw6IFwianMvcGFydGlhbHMvaW5mb3JtYXRpb24tZm9yLXRoZS1tYWdpc3RyYXRlLmh0bWxcIixcbiAgICAgICAgICBmb3JtX2ZpZWxkX25vdGU6ICdzaG93IG1vcmUnXG4gICAgICAgIH0sXG4gICAgICAgIG5nTW9kZWxBdHRyczoge1xuICAgICAgICAgIGZvcm1fZmllbGRfbm90ZToge2F0dHJpYnV0ZTogJ2Zvcm0tZmllbGQtbm90ZSd9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgXTtcblxuICAgICRzY29wZS5sb2FkTW9kYWwgPSBmdW5jdGlvbihtb2RhbCl7XG4gICAgICB2YXIgcGF0aCA9IFwianMvcGFydGlhbHMvXCI7XG4gICAgICAkbG9nLmxvZyhcInNob3dpbmcgXCIgKyBtb2RhbCk7XG4gICAgfTtcblxuICAgIHZtLmZpZWxkcy5kZWNsYXJhdGlvbiA9IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2Fja25vd2xlZGdlbWVudCcsXG4gICAgICAgIGtleTogJ2Fja25vd2xlZGdlbWVudCcsXG4gICAgICAgIHR5cGU6ICdjdXN0b21DaGVja2JveCcsXG4gICAgICAgIHRlbXBsYXRlT3B0aW9uczoge1xuICAgICAgICAgIG5vX2xhYmVsOiB0cnVlLFxuICAgICAgICAgIGxhYmVsOiAnSSBhY2tub3dsZWRnZSBJIG1heSBwbGVhZCBndWlsdHkgb3Igbm90IGd1aWx0eS4gSSBhY2tub3dsZWRnZSBubyBwb2xpY2Ugb2ZmaWNlciBvciBvdGhlciBwZXJzb24gdG9sZCBtZSB0byBwbGVhZCBndWlsdHknLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdwbGVhZF9ndWlsdHknLFxuICAgICAgICBrZXk6ICdwbGVhZF9ndWlsdHknLFxuICAgICAgICB0eXBlOiAnY3VzdG9tQ2hlY2tib3gnLFxuICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICBub19sYWJlbDogdHJ1ZSxcbiAgICAgICAgICBsYWJlbDogJ0kgcGxlYWQgZ3VpbHR5IHRvIHRoZSBvZmZlbmNlKHMpIGxpc3RlZCBpbiB0aGlzIGZvcm0uIFRoaXMgcGxlYSBpcyBlbnRlcmVkIHZvbHVudGFyaWx5IG9mIG15IG93biBmcmVlIHdpbGwnLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdO1xuXG5cbiAgICBmdW5jdGlvbiByZXNldEZvcm0oKXtcbiAgICAgIHZtLmVycm9ycyA9IHt9O1xuICAgICAgdm0ubW9kZWwgPSB7fTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlcnJvcigpe1xuICAgICAgJGxvZy5sb2coXCJFUlJPUlwiKTtcbiAgICAgICRhbGVydCh7XG4gICAgICAgIHRpdGxlOiAnSG9seSBndWFjYW1vbGUhJyxcbiAgICAgICAgY29udGVudDogJ0Jlc3QgY2hlY2sgeW8gc2VsZiwgeW91XFwncmUgbm90IGxvb2tpbmcgdG9vIGdvb2QuJyxcbiAgICAgICAgdHlwZTogJ2RhbmdlcicsXG4gICAgICAgIHNob3c6IGZhbHNlLFxuICAgICAgICBjb250YWluZXI6IFwiI2FsZXJ0LWNvbnRhaW5lclwiLFxuICAgICAgICBkdXJhdGlvbjogMjUwMCxcbiAgICAgICAgZGlzbWlzc2FibGU6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoY2FsbGJhY2spe1xuICAgICAgJGxvZy5sb2coXCJTdWNjZXNzXCIpO1xuICAgICAgJGFsZXJ0KHtcbiAgICAgICAgdGl0bGU6ICdIb2x5IGd1YWNhbW9sZSEnLFxuICAgICAgICBjb250ZW50OiAnQmVzdCBjaGVjayB5byBzZWxmLCB5b3VcXCdyZSBub3QgbG9va2luZyB0b28gZ29vZC4nLFxuICAgICAgICB0eXBlOiAnc3VjY2VzcycsXG4gICAgICAgIHNob3c6IHRydWUsXG4gICAgICAgIHBsYWNlbWVudDogJycsXG4gICAgICAgIGNvbnRhaW5lcjogXCIjYWxlcnQtY29udGFpbmVyXCIsXG4gICAgICAgIGR1cmF0aW9uOiA1LFxuICAgICAgICBkaXNtaXNzYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdCgpe1xuICAgICAgJGxvZy5sb2coXCJMb2FkZWQgdGhlIGZvcm0gY29udHJvbGxlclwiKTtcbiAgICB9XG5cbiAgICBpbml0KCk7XG4gIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG4gIC8vIEFwcCBib290c3RyYXBwaW5nICsgRElcbiAgLypAbmdJbmplY3QqL1xuICBhbmd1bGFyLm1vZHVsZSgnbmpjT25saW5lUGxlYXMnKVxuICAgIC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIEhvbWVDb250cm9sbGVyKTtcblxuICAvKkBuZ0luamVjdCovXG4gIGZ1bmN0aW9uIEhvbWVDb250cm9sbGVyKCRzY29wZSwgJGxvZywgJHJvb3RTY29wZSwgJHN0YXRlKXtcblxuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubW9kZWwgPSB7fTtcblxuICAgIHZtLmxvZ2luID0gZnVuY3Rpb24oKXtcbiAgICAgICRsb2cubG9nKFwiTG9nZ2luZyBpblwiKTtcbiAgICAgICRsb2cubG9nKCRyb290U2NvcGUpO1xuICAgICAgJGxvZy5sb2codm0pO1xuICAgICAgJHN0YXRlLmdvKFwidmlld2VyXCIpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBpbml0KCl7XG4gICAgICAkbG9nLmxvZyhcIkxvYWRlZCB0aGUgaG9tZSBjb250cm9sbGVyXCIpO1xuICAgIH1cblxuICAgIGluaXQoKTtcbiAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLmNvbnRyb2xsZXIoJ1llc05vTW9kYWxDb250cm9sbGVyJywgWWVzTm9Nb2RhbENvbnRyb2xsZXIpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gWWVzTm9Nb2RhbENvbnRyb2xsZXIoJHNjb3BlLCAkbG9nKXtcblxuICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICBmdW5jdGlvbiBpbml0KCl7XG4gICAgICAkbG9nLmxvZyhcIkxvYWRlZCB0aGUgeWVzIG5vIG1vZGFsXCIpO1xuICAgIH1cblxuICAgIGluaXQoKTtcbiAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gQXBwIGJvb3RzdHJhcHBpbmcgKyBESVxuICAvKkBuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLmRpcmVjdGl2ZSgnZm9ybVN0ZXBzJywgZnVuY3Rpb24oJGxvZyl7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogXCJFQVwiLCAvLyBlbGVtZW50IG9yIGF0dHJpYnV0ZSBvbmx5XG4gICAgICAgIHJlcGxhY2U6IHRydWUsIC8vIHJlcGxhY2UgdGhlIGVsZW1lbnRcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9wYXJ0aWFscy9mb3JtLXN0ZXBzLmRpcmVjdGl2ZS5odG1sJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAnc3RlcHMnOiAnPScsXG4gICAgICAgICAgJ2N1cnJlbnQnOiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHJzKXtcbiAgICAgICAgICAkbG9nLmxvZyhcIkZvcm0gc3RlcHMgZGlyZWN0aXZlXCIpO1xuICAgICAgICAgICRsb2cubG9nKHNjb3BlKTtcbiAgICAgICAgICAkbG9nLmxvZyhlbGVtKTtcbiAgICAgICAgICAkbG9nLmxvZyhhdHRycyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyBBcHAgYm9vdHN0cmFwcGluZyArIERJXG4gIC8qQG5nSW5qZWN0Ki9cbiAgYW5ndWxhci5tb2R1bGUoJ25qY09ubGluZVBsZWFzJylcbiAgLmRpcmVjdGl2ZSgnZm9ybWx5RXJyb3JTdW1tYXJ5JywgZnVuY3Rpb24oJGxvZykge1xuICAgIHJldHVybiB7XG4gICAgICBzY29wZToge30sXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB7XG4gICAgICAgIGZvcm06ICc9JyxcbiAgICAgICAgZmllbGRzOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJ2pzL3BhcnRpYWxzL2Zvcm1seS1lcnJvci1zdW1tYXJ5LmRpcmVjdGl2ZS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLmdldEVycm9yQXNMaXN0ID0gZ2V0RXJyb3JBc0xpc3Q7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0RXJyb3JBc0xpc3QoZmllbGQpIHtcbiAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoZmllbGQuZm9ybUNvbnRyb2wuJGVycm9yKS5tYXAoZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIG5vdGUsIHRoaXMgb25seSB3b3JrcyBiZWNhdXNlIHRoZSBjdXN0b21JbnB1dCB0eXBlIHdlIGhhdmUgZGVmaW5lZC5cbiAgICAgICAgICAgIHJldHVybiBmaWVsZC5kYXRhLmdldFZhbGlkYXRpb25NZXNzYWdlKGVycm9yKTtcbiAgICAgICAgICB9KS5qb2luKCcsICcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyBBcHAgYm9vdHN0cmFwcGluZyArIERJXG4gIC8qQG5nSW5qZWN0Ki9cbiAgYW5ndWxhci5tb2R1bGUoJ25qY09ubGluZVBsZWFzJylcbiAgICAuZGlyZWN0aXZlKCdyYXRpbmcnLCBmdW5jdGlvbiAoJGxvZykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiRUFcIiwgLy8gZWxlbWVudCBvciBhdHRyaWJ1dGUgb25seVxuICAgICAgICByZXBsYWNlOiB0cnVlLCAvLyByZXBsYWNlIHRoZSBlbGVtZW50XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnanMvcGFydGlhbHMvcmF0aW5nLmRpcmVjdGl2ZS5odG1sJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRsb2csIFJhdGluZ1NlcnZpY2Upe1xuICAgICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgICAgJGxvZy5sb2coXCJDb250cm9sbGVyXCIpO1xuXG4gICAgICAgICAgdm0uc3VibWl0dGVkID0gZmFsc2U7XG5cbiAgICAgICAgICB2bS5tb2RlbCA9IHt9O1xuICAgICAgICAgIHZtLnJhdGluZ19vcHRpb25zID0gW1xuICAgICAgICAgICAge1wibGFiZWxcIjogMSwgXCJ2YWx1ZVwiOiAxLCBcInZhbHVlX3RleHRcIjogXCJWZXJ5IGRpZmZpY3VsdFwifSxcbiAgICAgICAgICAgIHtcImxhYmVsXCI6IDIsIFwidmFsdWVcIjogMn0sXG4gICAgICAgICAgICB7XCJsYWJlbFwiOiAzLCBcInZhbHVlXCI6IDN9LFxuICAgICAgICAgICAge1wibGFiZWxcIjogNCwgXCJ2YWx1ZVwiOiA0fSxcbiAgICAgICAgICAgIHtcImxhYmVsXCI6IDUsIFwidmFsdWVcIjogNX0sXG4gICAgICAgICAgICB7XCJsYWJlbFwiOiA2LCBcInZhbHVlXCI6IDZ9LFxuICAgICAgICAgICAge1wibGFiZWxcIjogNywgXCJ2YWx1ZVwiOiA3LCBcInZhbHVlX3RleHRcIjogXCJWZXJ5IGVhc3lcIn1cbiAgICAgICAgICBdO1xuXG4gICAgICAgICAgdm0uZmllbGRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0eXBlOiAnY3VzdG9tUmF0aW5nUmFkaW8nLFxuICAgICAgICAgICAgICBrZXk6ICdyYXRpbmcnLFxuICAgICAgICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBsYWJlbDogXCJPdmVyYWxsLCBob3cgZGlmZmljdWx0IG9yIGVhc3kgZGlkIHlvdSBmaW5kIHRoaXMgdGFzaz9cIixcbiAgICAgICAgICAgICAgICBsYWJlbFByb3A6ICdsYWJlbCcsXG4gICAgICAgICAgICAgICAgdmFsdWVQcm9wOiAndmFsdWUnLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHZtLnJhdGluZ19vcHRpb25zXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR5cGU6ICd0ZXh0YXJlYScsXG4gICAgICAgICAgICAgIGtleTogJ2NvbW1lbnRzJyxcbiAgICAgICAgICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgbGFiZWw6IFwiQ29tbWVudHNcIixcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogZmFsc2VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF07XG5cbiAgICAgICAgICB2bS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgUmF0aW5nU2VydmljZVxuICAgICAgICAgICAgICAuY3JlYXRlKHZtLm1vZGVsKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICB2bS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICRsb2cubG9nKGVycik7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRycyl7XG4gICAgICAgICAgJGxvZy5sb2coXCJSYXRpbmcgZGlyZWN0aXZlXCIpO1xuICAgICAgICAgICRsb2cubG9nKHNjb3BlKTtcbiAgICAgICAgICAkbG9nLmxvZyhlbGVtKTtcbiAgICAgICAgICAkbG9nLmxvZyhhdHRycyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSk7XG5cbn0pKCk7XG4iLCIvLyBEdW1teSBkYXRhIHNlcnZpY2VcbihmdW5jdGlvbigpe1xuICAndXNlIHN0cmljdCc7XG5cbiAgLypuZ0luamVjdCovXG4gIGFuZ3VsYXIubW9kdWxlKCduamNPbmxpbmVQbGVhcycpXG4gICAgLnNlcnZpY2UoJ1JhdGluZ1NlcnZpY2UnLCBSYXRpbmdTZXJ2aWNlKTtcblxuICAvKm5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gUmF0aW5nU2VydmljZSgkbG9nLCAkaHR0cCl7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY3JlYXRlOiBmdW5jdGlvbihyYXRpbmcpe1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgncmF0aW5ncycsIHJhdGluZyk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufSkoKTtcbiJdfQ==
